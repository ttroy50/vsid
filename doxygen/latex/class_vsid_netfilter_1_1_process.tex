\hypertarget{class_vsid_netfilter_1_1_process}{\section{Vsid\-Netfilter\-:\-:Process Class Reference}
\label{class_vsid_netfilter_1_1_process}\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}}
}


{\ttfamily \#include $<$Process.\-h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
virtual \hyperlink{class_vsid_netfilter_1_1_process_a26fb4644e2608c2befc2065ac6a37bc9}{$\sim$\-Process} ()
\item 
bool \hyperlink{class_vsid_netfilter_1_1_process_add484e8839f34ceb0287c50795a20393}{initialise} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\item 
bool \hyperlink{class_vsid_netfilter_1_1_process_a9377b702ba19852c7747cde2459ff6dc}{run} ()
\item 
void \hyperlink{class_vsid_netfilter_1_1_process_aacbfb7cd570ebf00be2e6f2551b2562b}{shutdown} ()
\item 
virtual void \hyperlink{class_vsid_netfilter_1_1_process_a39de55e5a688f6eb51aeb446767b2631}{set\-Up\-Signals} (void($\ast$sig\-\_\-fn)(int))
\item 
virtual void \hyperlink{class_vsid_netfilter_1_1_process_a4c6eca4e8b5731e78b13ff8a4f9935d9}{usage} (const char $\ast$command)
\item 
virtual \hyperlink{class_vsid_netfilter_1_1_process_a26fb4644e2608c2befc2065ac6a37bc9}{$\sim$\-Process} ()
\item 
bool \hyperlink{class_vsid_netfilter_1_1_process_a13da9bf5f1dadf8343ff684c300fe35e}{initialise} (int argc, char $\ast$argv\mbox{[}$\,$\mbox{]})
\item 
bool \hyperlink{class_vsid_netfilter_1_1_process_aa477798d1d86d5fbe3c84e95c1eb87b0}{run} ()
\item 
void \hyperlink{class_vsid_netfilter_1_1_process_af6bc3c365e14a14a3e897c5685155c7f}{shutdown} ()
\item 
virtual void \hyperlink{class_vsid_netfilter_1_1_process_a38598a0db031d475eb3efd134225ddb4}{set\-Up\-Signals} (void($\ast$sig\-\_\-fn)(int))
\item 
virtual void \hyperlink{class_vsid_netfilter_1_1_process_afc97abd9b61de7cf8ed12a0e78970641}{usage} (const char $\ast$command)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{class_vsid_netfilter_1_1_process}{Process} $\ast$ \hyperlink{class_vsid_netfilter_1_1_process_a56a4c6294170fa3abf87a7a214ff4cea}{instance} ()
\item 
static int \hyperlink{class_vsid_netfilter_1_1_process_a493320d910acedafea3e56331ef509c8}{sig\-Received} ()
\item 
static void \hyperlink{class_vsid_netfilter_1_1_process_a8ce6bfc52161fc696d3dc931334a8f35}{sig\-Received} (int sig)
\item 
static \hyperlink{class_vsid_netfilter_1_1_process}{Process} $\ast$ \hyperlink{class_vsid_netfilter_1_1_process_a3d99f7270319a46fb979a2b851c8b050}{instance} ()
\item 
static int \hyperlink{class_vsid_netfilter_1_1_process_a493320d910acedafea3e56331ef509c8}{sig\-Received} ()
\item 
static void \hyperlink{class_vsid_netfilter_1_1_process_a8ce6bfc52161fc696d3dc931334a8f35}{sig\-Received} (int sig)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
Main class to run the process from 

Definition at line 24 of file Process.\-h.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{class_vsid_netfilter_1_1_process_a26fb4644e2608c2befc2065ac6a37bc9}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!$\sim$\-Process@{$\sim$\-Process}}
\index{$\sim$\-Process@{$\sim$\-Process}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{$\sim$\-Process}]{\setlength{\rightskip}{0pt plus 5cm}virtual Vsid\-Netfilter\-::\-Process\-::$\sim$\-Process (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}}\label{class_vsid_netfilter_1_1_process_a26fb4644e2608c2befc2065ac6a37bc9}


Definition at line 28 of file Process.\-h.


\begin{DoxyCode}
28 \{\}
\end{DoxyCode}
\hypertarget{class_vsid_netfilter_1_1_process_a26fb4644e2608c2befc2065ac6a37bc9}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!$\sim$\-Process@{$\sim$\-Process}}
\index{$\sim$\-Process@{$\sim$\-Process}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{$\sim$\-Process}]{\setlength{\rightskip}{0pt plus 5cm}virtual Vsid\-Netfilter\-::\-Process\-::$\sim$\-Process (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [virtual]}}}\label{class_vsid_netfilter_1_1_process_a26fb4644e2608c2befc2065ac6a37bc9}


Definition at line 28 of file Process.\-h.


\begin{DoxyCode}
28 \{\}
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{class_vsid_netfilter_1_1_process_add484e8839f34ceb0287c50795a20393}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!initialise@{initialise}}
\index{initialise@{initialise}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{initialise}]{\setlength{\rightskip}{0pt plus 5cm}bool Process\-::initialise (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{class_vsid_netfilter_1_1_process_add484e8839f34ceb0287c50795a20393}
Initialise the server


\begin{DoxyParams}{Parameters}
{\em argc} & \mbox{[}description\mbox{]} \\
\hline
{\em argv} & \mbox{[}description\mbox{]}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 112 of file Process.\-cpp.


\begin{DoxyCode}
113 \{
114     \hyperlink{class_vsid_netfilter_1_1_process_a39de55e5a688f6eb51aeb446767b2631}{setUpSignals}(&\hyperlink{netfilter_2src_2_process_8cpp_a814b3182732c43ae1880f52e753b6688}{exitOnSignal});
115 
116 
117     \textcolor{keywordtype}{string} protocol\_db;
118     \textcolor{keywordtype}{bool} protocol\_db\_set = \textcolor{keyword}{false};
119     \textcolor{keywordtype}{string} config = \textcolor{stringliteral}{"config.yaml"};
120     \textcolor{keywordtype}{string} training;
121 
122     \textcolor{keywordtype}{char} c;
123     \textcolor{keywordflow}{while} ( (c = getopt(argc, argv, \textcolor{stringliteral}{":hc:d:"}) ) != -1) 
124     \{
125         \textcolor{keywordflow}{switch} (c) 
126         \{
127             \textcolor{keywordflow}{case} \textcolor{charliteral}{'d'}:
128                 \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"-d "} << optarg);
129                 protocol\_db = optarg;
130                 \textcolor{keywordflow}{break};
131             \textcolor{keywordflow}{case} \textcolor{charliteral}{'c'}:
132                 \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"-c "} << optarg);
133                 config = optarg;
134                 \textcolor{keywordflow}{break};
135             \textcolor{keywordflow}{case} \textcolor{charliteral}{'h'}:
136                 \hyperlink{class_vsid_netfilter_1_1_process_a4c6eca4e8b5731e78b13ff8a4f9935d9}{usage}(argv[0]);
137                 exit(0);
138                 \textcolor{keywordflow}{break};
139             \textcolor{keywordflow}{case} \textcolor{charliteral}{':'}:
140                 cerr << \textcolor{stringliteral}{"ERROR: Option "} << (char)optopt << \textcolor{stringliteral}{" requires an argument."} << endl;
141                 \hyperlink{class_vsid_netfilter_1_1_process_a4c6eca4e8b5731e78b13ff8a4f9935d9}{usage}(argv[0]);
142                 exit(1);
143                 \textcolor{keywordflow}{break};
144             \textcolor{keywordflow}{case} \textcolor{charliteral}{'?'}:
145             \textcolor{keywordflow}{default}:
146                 cerr << \textcolor{stringliteral}{"ERROR: Unrecognised Option : "} << (char)optopt << endl;
147                 \hyperlink{class_vsid_netfilter_1_1_process_a4c6eca4e8b5731e78b13ff8a4f9935d9}{usage}(argv[0]);
148                 exit(1);
149                 \textcolor{keywordflow}{break};
150         \}
151     \}
152 
153     \hyperlink{_attribute_meter_registrar_8h_acc628170f0b90d7876378e03d3159647}{init\_attribute\_meters}();
154 
155     \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"config file : "} << config);
156 
157     \textcolor{keywordflow}{if} ( !\hyperlink{class_vsid_netfilter_1_1_config_abf1d4539011ef83cac0fef2ac864a3a9}{Config::instance}()->init(config) )
158     \{
159         \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}( << \textcolor{stringliteral}{"Unable to initialise configuration"});
160         cerr << \textcolor{stringliteral}{"ERROR: Unable to initialise configuration"} << endl;
161         exit(1);
162     \}
163 
164     
165     \textcolor{keywordflow}{if}( !protocol\_db.empty() )
166     \{
167         \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}( << \textcolor{stringliteral}{"overriding protocol\_db from config : "} << protocol\_db); 
168         \hyperlink{class_vsid_netfilter_1_1_config_abf1d4539011ef83cac0fef2ac864a3a9}{Config::instance}()->\hyperlink{class_vsid_netfilter_1_1_config_ae34621f4ec48a1f8354f006b150098ab}{protocolDatabase}(protocol\_db);
169     \}
170 
171     \textcolor{keywordflow}{if}(\hyperlink{class_vsid_netfilter_1_1_config_abf1d4539011ef83cac0fef2ac864a3a9}{Config::instance}()->protocolDatabase().empty())
172     \{
173         \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}(<< \textcolor{stringliteral}{"No spid database configured"})
174         cerr << "No spid database configured" << endl;
175         exit(1);
176     \}
177 
178     \_protocolModelDb = std::shared\_ptr<\hyperlink{class_vsid_1_1_protocol_model_db}{ProtocolModelDb}> ( 
179                                             new \hyperlink{class_vsid_1_1_protocol_model_db}{ProtocolModelDb}(
180                                                 \hyperlink{class_vsid_netfilter_1_1_config}{Config}::\hyperlink{class_vsid_netfilter_1_1_process_a56a4c6294170fa3abf87a7a214ff4cea}{instance}()->protocolDatabase(), "") )
      ;
181     
182     if( !\_protocolModelDb->read() )
183     \{
184         \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}(<< \textcolor{stringliteral}{"Unable to read DB at ["} << \hyperlink{class_vsid_netfilter_1_1_config_abf1d4539011ef83cac0fef2ac864a3a9}{Config::instance}()->
      protocolDatabase() << \textcolor{stringliteral}{"]"})
185         cerr << "Unable to read DB at [" << \hyperlink{class_vsid_netfilter_1_1_config}{Config}::\hyperlink{class_vsid_netfilter_1_1_process_a56a4c6294170fa3abf87a7a214ff4cea}{instance}()->protocolDatabase() << "]" << 
      endl;
186         exit(1);
187     \}
188 
189     \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< "spid database : " << \hyperlink{class_vsid_netfilter_1_1_config}{Config}::\hyperlink{class_vsid_netfilter_1_1_process_a56a4c6294170fa3abf87a7a214ff4cea}{instance}()->protocolDatabase());
190 
191     \textcolor{comment}{// Start the trace file for classification}
192     \hyperlink{_logger_8h_a92056d6f812b14acf33d9e27b9b1f157}{SLOG\_TRACE}( << "---"
193                 << std::endl
194                 << "ProtocolDatabase: \{\textcolor{stringliteral}{" }
195 \textcolor{stringliteral}{                << "}FileName: \textcolor{stringliteral}{" << \_protocolModelDb->filename() }
196 \textcolor{stringliteral}{                << "}, LastModifiedTime: \textcolor{stringliteral}{" << \_protocolModelDb->lastModifiedTimeAsString()}
197 \textcolor{stringliteral}{                << "}, CutoffLimit: \textcolor{stringliteral}{" << \_protocolModelDb->cutoffLimit()}
198 \textcolor{stringliteral}{                << "}, DefiningLimit: \textcolor{stringliteral}{" << \_protocolModelDb->definingLimit()}
199 \textcolor{stringliteral}{                << "}\}\textcolor{stringliteral}{" << std::endl}
200 \textcolor{stringliteral}{                << "}KLDivergenceThreshold: \textcolor{stringliteral}{" << CommonConfig::instance()->divergenceThreshold() <<
       std::endl}
201 \textcolor{stringliteral}{                << "}Input: NfQueue\textcolor{stringliteral}{" << std::endl}
202 \textcolor{stringliteral}{                << "}Results: \textcolor{stringliteral}{");}
203 \textcolor{stringliteral}{}
204 \textcolor{stringliteral}{    return true;}
205 \textcolor{stringliteral}{\}}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_netfilter_1_1_process_add484e8839f34ceb0287c50795a20393_cgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_netfilter_1_1_process_a13da9bf5f1dadf8343ff684c300fe35e}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!initialise@{initialise}}
\index{initialise@{initialise}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{initialise}]{\setlength{\rightskip}{0pt plus 5cm}bool Vsid\-Netfilter\-::\-Process\-::initialise (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$}]{argv\mbox{[}$\,$\mbox{]}}
\end{DoxyParamCaption}
)}}\label{class_vsid_netfilter_1_1_process_a13da9bf5f1dadf8343ff684c300fe35e}
Initialise the server


\begin{DoxyParams}{Parameters}
{\em argc} & \mbox{[}description\mbox{]} \\
\hline
{\em argv} & \mbox{[}description\mbox{]}\\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\hypertarget{class_vsid_netfilter_1_1_process_a3d99f7270319a46fb979a2b851c8b050}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!instance@{instance}}
\index{instance@{instance}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{instance}]{\setlength{\rightskip}{0pt plus 5cm}static {\bf Process}$\ast$ Vsid\-Netfilter\-::\-Process\-::instance (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{class_vsid_netfilter_1_1_process_a3d99f7270319a46fb979a2b851c8b050}
\hypertarget{class_vsid_netfilter_1_1_process_a56a4c6294170fa3abf87a7a214ff4cea}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!instance@{instance}}
\index{instance@{instance}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{instance}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Process} $\ast$ Process\-::instance (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{class_vsid_netfilter_1_1_process_a56a4c6294170fa3abf87a7a214ff4cea}


Definition at line 39 of file Process.\-cpp.


\begin{DoxyCode}
40 \{
41     std::call\_once(\_onceFlag,
42         [] \{
43     \textcolor{keywordflow}{if}(!\_instance) 
44             \_instance.reset(\textcolor{keyword}{new} \hyperlink{class_vsid_netfilter_1_1_process}{Process});
45         \}
46     );
47 
48     \textcolor{keywordflow}{return} \_instance.get();
49 \}
\end{DoxyCode}
\hypertarget{class_vsid_netfilter_1_1_process_aa477798d1d86d5fbe3c84e95c1eb87b0}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!run@{run}}
\index{run@{run}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{run}]{\setlength{\rightskip}{0pt plus 5cm}bool Vsid\-Netfilter\-::\-Process\-::run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{class_vsid_netfilter_1_1_process_aa477798d1d86d5fbe3c84e95c1eb87b0}
Run the main event loop

\begin{DoxyReturn}{Returns}

\end{DoxyReturn}
\hypertarget{class_vsid_netfilter_1_1_process_a9377b702ba19852c7747cde2459ff6dc}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!run@{run}}
\index{run@{run}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{run}]{\setlength{\rightskip}{0pt plus 5cm}bool Process\-::run (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{class_vsid_netfilter_1_1_process_a9377b702ba19852c7747cde2459ff6dc}
Run the main event loop

\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 208 of file Process.\-cpp.


\begin{DoxyCode}
209 \{
210 
211     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < \hyperlink{class_vsid_netfilter_1_1_config_abf1d4539011ef83cac0fef2ac864a3a9}{Config::instance}()->\hyperlink{class_vsid_netfilter_1_1_config_a911c8515f185b48bf4ad1cac8fa869d8}{numQueues}(); i++ )
212     \{
213         \textcolor{keywordflow}{try}
214         \{
215             \textcolor{keywordtype}{int} offset = \hyperlink{class_vsid_netfilter_1_1_config_abf1d4539011ef83cac0fef2ac864a3a9}{Config::instance}()->\hyperlink{class_vsid_netfilter_1_1_config_a9812d0584ac789366f5419acec1a6c77}{queueOffset}() + i;
216             std::shared\_ptr<PacketHandler> handler(\textcolor{keyword}{new} \hyperlink{class_vsid_netfilter_1_1_packet_handler}{PacketHandler}(offset, \_protocolModelDb.
      get()));
217             \_packetHandlers.push\_back(handler);
218 
219             \_handlerThreads.push\_back( std::thread(&\hyperlink{class_vsid_netfilter_1_1_packet_handler_a351a43a68f29a0f19a7baccebe1397e9}{PacketHandler::run}, handler) );
220 
221         \}
222         \textcolor{keywordflow}{catch}(\hyperlink{class_vsid_common_1_1_string_exception}{StringException}& ex)
223         \{
224             \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}( << \textcolor{stringliteral}{"Exception : "} << ex.\hyperlink{class_vsid_common_1_1_string_exception_aee0da3bd4d08cb375d39defc77ae923c}{what}() )
225             exit(1);
226         \}
227     \}
228     
229     std::time\_t last = std::time(\textcolor{keyword}{nullptr});
230     std::time\_t now = std::time(\textcolor{keyword}{nullptr});
231 
232     \textcolor{keywordflow}{while} (!\_shutdown)
233     \{
234         std::this\_thread::sleep\_for(std::chrono::seconds(1));
235         now = std::time(\textcolor{keyword}{nullptr});
236         \textcolor{keywordflow}{if}(now - last > 30)
237         \{
238             std::cout << \textcolor{stringliteral}{"stats at: "} << std::ctime(&now) << \textcolor{charliteral}{'\(\backslash\)n'};
239             \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} t : \_packetHandlers)\{
240                 cout << \textcolor{stringliteral}{"Queue ["} << t->queueNumber() << \textcolor{stringliteral}{"] received ["} << t->numPackets() << \textcolor{stringliteral}{"]"} << endl;
241                 std::vector<uint64\_t> vs = t->verdictStats();
242                 cout << \textcolor{stringliteral}{"Open Flows ["}  << t->openFlows() << \textcolor{stringliteral}{"]"} << endl;
243                 cout << \textcolor{stringliteral}{"verdicts: "} << endl;
244                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < vs.size(); ++i)
245                 \{
246                     cout << \textcolor{stringliteral}{"\(\backslash\)t"} << i << \textcolor{stringliteral}{" = "} << vs[i] << endl;
247                 \}
248                 cout << \textcolor{stringliteral}{"--------------------------"} << endl;
249             \}
250             cout << \textcolor{stringliteral}{"--------------------------"} << endl;
251             last = now;
252         \}
253     \}
254 
255     \textcolor{comment}{//Join the threads with the main thread}
256     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} &t : \_handlerThreads)\{
257         t.join();
258     \}
259 
260     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
261 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_netfilter_1_1_process_a9377b702ba19852c7747cde2459ff6dc_cgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_netfilter_1_1_process_a38598a0db031d475eb3efd134225ddb4}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!set\-Up\-Signals@{set\-Up\-Signals}}
\index{set\-Up\-Signals@{set\-Up\-Signals}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{set\-Up\-Signals}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Vsid\-Netfilter\-::\-Process\-::set\-Up\-Signals (
\begin{DoxyParamCaption}
\item[{void($\ast$)(int)}]{sig\-\_\-fn}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_vsid_netfilter_1_1_process_a38598a0db031d475eb3efd134225ddb4}
Set up all signals


\begin{DoxyParams}{Parameters}
{\em signal} & function \\
\hline
\end{DoxyParams}
\hypertarget{class_vsid_netfilter_1_1_process_a39de55e5a688f6eb51aeb446767b2631}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!set\-Up\-Signals@{set\-Up\-Signals}}
\index{set\-Up\-Signals@{set\-Up\-Signals}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{set\-Up\-Signals}]{\setlength{\rightskip}{0pt plus 5cm}void Process\-::set\-Up\-Signals (
\begin{DoxyParamCaption}
\item[{void($\ast$)(int)}]{sig\-\_\-fn}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_vsid_netfilter_1_1_process_a39de55e5a688f6eb51aeb446767b2631}
Set up all signals


\begin{DoxyParams}{Parameters}
{\em signal} & function \\
\hline
\end{DoxyParams}


Definition at line 60 of file Process.\-cpp.


\begin{DoxyCode}
61 \{
62         \textcolor{keyword}{struct }sigaction action;
63 
64         \textcolor{comment}{// Set up signal handlers for sigintr/sigterm/sigquit to exit process cleanly}
65         action.sa\_handler = sig\_fn;
66         sigemptyset(&action.sa\_mask);
67         action.sa\_flags = 0;
68 
69         \textcolor{keywordtype}{int} sig\_err = sigaction(SIGINT, &action, NULL);
70         \textcolor{keywordflow}{if} (sig\_err)
71         \{
72                 \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}( << \textcolor{stringliteral}{"ERROR: setting sig handler for SIGINT ["} << errno << \textcolor{stringliteral}{"] - ["}
73                         << strerror(errno) << \textcolor{stringliteral}{"]"} );
74         \}
75 
76         \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}( << \textcolor{stringliteral}{"Initialised signal handler for SIGINT"});
77 
78         sig\_err = sigaction(SIGTERM, &action, NULL);
79         \textcolor{keywordflow}{if} (sig\_err)
80         \{
81                 \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}( << \textcolor{stringliteral}{"ERROR: setting sig handler for SIGTERM ["} << errno << \textcolor{stringliteral}{"] - ["}
82                         << strerror(errno) << \textcolor{stringliteral}{"]"} );
83         \}
84         
85         \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"Initialised signal handler for SIGTERM"});
86 
87         sig\_err = sigaction(SIGQUIT, &action, NULL);
88         \textcolor{keywordflow}{if} (sig\_err)
89         \{
90                 \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}( << \textcolor{stringliteral}{"ERROR: setting sig handler for SIGQUIT ["} << errno << \textcolor{stringliteral}{"] - ["}
91                         << strerror(errno) << \textcolor{stringliteral}{"]"} );
92         \}
93         \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"Initialised signal handler for SIGQUIT"});
94 
95         \textcolor{keywordflow}{return};
96 \}
\end{DoxyCode}
\hypertarget{class_vsid_netfilter_1_1_process_aacbfb7cd570ebf00be2e6f2551b2562b}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!shutdown@{shutdown}}
\index{shutdown@{shutdown}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{shutdown}]{\setlength{\rightskip}{0pt plus 5cm}void Process\-::shutdown (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{class_vsid_netfilter_1_1_process_aacbfb7cd570ebf00be2e6f2551b2562b}
Shutdown the process 

Definition at line 263 of file Process.\-cpp.


\begin{DoxyCode}
264 \{
265     \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"Received shutdown command. Signal Received ["} << \_sigReceived << \textcolor{stringliteral}{"]"});
266     \_shutdown = \textcolor{keyword}{true};
267 
268     std::time\_t now = std::time(\textcolor{keyword}{nullptr});
269     std::cout << \textcolor{stringliteral}{"stats before shutdown: "} << std::ctime(&now) << \textcolor{charliteral}{'\(\backslash\)n'};
270     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} &t : \_packetHandlers) \{
271         cout << \textcolor{stringliteral}{"Queue ["} << t->queueNumber() << \textcolor{stringliteral}{"] received ["} << t->numPackets() << \textcolor{stringliteral}{"]"} << endl;
272         std::vector<uint64\_t> vs = t->verdictStats();
273         cout << \textcolor{stringliteral}{"Open Flows ["}  << t->openFlows() << \textcolor{stringliteral}{"]"} << endl;
274         cout << \textcolor{stringliteral}{"verdicts: "} << endl;
275         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < vs.size(); ++i)
276         \{
277             cout << \textcolor{stringliteral}{"\(\backslash\)t"} << i << \textcolor{stringliteral}{" = "} << vs[i] << endl;
278         \}
279         cout << \textcolor{stringliteral}{"--------------------------"} << endl;
280     \}
281 
282     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} &t : \_packetHandlers)\{
283         t->shutdown();
284     \}
285     cout << endl << \textcolor{stringliteral}{"--------------------------"} << endl << endl;
286     now = std::time(\textcolor{keyword}{nullptr});
287     std::cout << \textcolor{stringliteral}{"stats at shutdown: "} << std::ctime(&now) << \textcolor{charliteral}{'\(\backslash\)n'};
288     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} &t : \_packetHandlers) \{
289         cout << \textcolor{stringliteral}{"Queue ["} << t->queueNumber() << \textcolor{stringliteral}{"] received ["} << t->numPackets() << \textcolor{stringliteral}{"]"} << endl;
290         std::vector<uint64\_t> vs = t->verdictStats();
291         cout << \textcolor{stringliteral}{"Open Flows ["}  << t->openFlows() << \textcolor{stringliteral}{"]"} << endl;
292         cout << \textcolor{stringliteral}{"verdicts: "} << endl;
293         \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < vs.size(); ++i)
294         \{
295             cout << \textcolor{stringliteral}{"\(\backslash\)t"} << i << \textcolor{stringliteral}{" = "} << vs[i] << endl;
296         \}
297         cout << \textcolor{stringliteral}{"--------------------------"} << endl;
298     \}
299 \}
\end{DoxyCode}
\hypertarget{class_vsid_netfilter_1_1_process_af6bc3c365e14a14a3e897c5685155c7f}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!shutdown@{shutdown}}
\index{shutdown@{shutdown}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{shutdown}]{\setlength{\rightskip}{0pt plus 5cm}void Vsid\-Netfilter\-::\-Process\-::shutdown (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{class_vsid_netfilter_1_1_process_af6bc3c365e14a14a3e897c5685155c7f}
Shutdown the process \hypertarget{class_vsid_netfilter_1_1_process_a493320d910acedafea3e56331ef509c8}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!sig\-Received@{sig\-Received}}
\index{sig\-Received@{sig\-Received}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{sig\-Received}]{\setlength{\rightskip}{0pt plus 5cm}static int Vsid\-Netfilter\-::\-Process\-::sig\-Received (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{class_vsid_netfilter_1_1_process_a493320d910acedafea3e56331ef509c8}
Last signal received 

Definition at line 55 of file Process.\-h.


\begin{DoxyCode}
55 \{ \textcolor{keywordflow}{return} \_sigReceived; \}
\end{DoxyCode}
\hypertarget{class_vsid_netfilter_1_1_process_a493320d910acedafea3e56331ef509c8}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!sig\-Received@{sig\-Received}}
\index{sig\-Received@{sig\-Received}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{sig\-Received}]{\setlength{\rightskip}{0pt plus 5cm}static int Vsid\-Netfilter\-::\-Process\-::sig\-Received (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{class_vsid_netfilter_1_1_process_a493320d910acedafea3e56331ef509c8}
Last signal received 

Definition at line 55 of file Process.\-h.


\begin{DoxyCode}
55 \{ \textcolor{keywordflow}{return} \_sigReceived; \}
\end{DoxyCode}
\hypertarget{class_vsid_netfilter_1_1_process_a8ce6bfc52161fc696d3dc931334a8f35}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!sig\-Received@{sig\-Received}}
\index{sig\-Received@{sig\-Received}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{sig\-Received}]{\setlength{\rightskip}{0pt plus 5cm}static void Vsid\-Netfilter\-::\-Process\-::sig\-Received (
\begin{DoxyParamCaption}
\item[{int}]{sig}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{class_vsid_netfilter_1_1_process_a8ce6bfc52161fc696d3dc931334a8f35}


Definition at line 56 of file Process.\-h.


\begin{DoxyCode}
56 \{ \_sigReceived = sig; \}
\end{DoxyCode}
\hypertarget{class_vsid_netfilter_1_1_process_a8ce6bfc52161fc696d3dc931334a8f35}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!sig\-Received@{sig\-Received}}
\index{sig\-Received@{sig\-Received}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{sig\-Received}]{\setlength{\rightskip}{0pt plus 5cm}static void Vsid\-Netfilter\-::\-Process\-::sig\-Received (
\begin{DoxyParamCaption}
\item[{int}]{sig}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [static]}}}\label{class_vsid_netfilter_1_1_process_a8ce6bfc52161fc696d3dc931334a8f35}


Definition at line 56 of file Process.\-h.


\begin{DoxyCode}
56 \{ \_sigReceived = sig; \}
\end{DoxyCode}
\hypertarget{class_vsid_netfilter_1_1_process_a4c6eca4e8b5731e78b13ff8a4f9935d9}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!usage@{usage}}
\index{usage@{usage}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{usage}]{\setlength{\rightskip}{0pt plus 5cm}void Process\-::usage (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{command}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_vsid_netfilter_1_1_process_a4c6eca4e8b5731e78b13ff8a4f9935d9}
Print the program usage


\begin{DoxyParams}{Parameters}
{\em The} & name of the program i.\-e. argv\mbox{[}0\mbox{]} \\
\hline
\end{DoxyParams}


Definition at line 99 of file Process.\-cpp.


\begin{DoxyCode}
100 \{
101     \textcolor{comment}{//cout << endl << gvProgramName <<  endl << endl;}
102     cout << \textcolor{stringliteral}{"Usage : "} << command << \textcolor{stringliteral}{" [-h] [-c <config\_file>] [-d database\_file]"};
103     cout << \textcolor{stringliteral}{"Options :"} << endl 
104         << \textcolor{stringliteral}{" -c \(\backslash\)t Config file "} << endl
105         << \textcolor{stringliteral}{" -l \(\backslash\)t Logging Config "} << endl
106         << \textcolor{stringliteral}{" -d \(\backslash\)t VSI SPID database file. Overrides the one from config file"} << endl
107         << \textcolor{stringliteral}{" -h \(\backslash\)t print this help and exit"} << endl;
108 
109 \}
\end{DoxyCode}
\hypertarget{class_vsid_netfilter_1_1_process_afc97abd9b61de7cf8ed12a0e78970641}{\index{Vsid\-Netfilter\-::\-Process@{Vsid\-Netfilter\-::\-Process}!usage@{usage}}
\index{usage@{usage}!VsidNetfilter::Process@{Vsid\-Netfilter\-::\-Process}}
\subsubsection[{usage}]{\setlength{\rightskip}{0pt plus 5cm}virtual void Vsid\-Netfilter\-::\-Process\-::usage (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{command}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [virtual]}}}\label{class_vsid_netfilter_1_1_process_afc97abd9b61de7cf8ed12a0e78970641}
Print the program usage


\begin{DoxyParams}{Parameters}
{\em The} & name of the program i.\-e. argv\mbox{[}0\mbox{]} \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
src/netfilter/inc/\hyperlink{netfilter_2inc_2_process_8h}{Process.\-h}\item 
src/netfilter/src/\hyperlink{netfilter_2src_2_process_8cpp}{Process.\-cpp}\end{DoxyCompactItemize}
