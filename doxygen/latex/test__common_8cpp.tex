\hypertarget{test__common_8cpp}{\section{src/common/unit\-\_\-test/test\-\_\-common.cpp File Reference}
\label{test__common_8cpp}\index{src/common/unit\-\_\-test/test\-\_\-common.\-cpp@{src/common/unit\-\_\-test/test\-\_\-common.\-cpp}}
}
{\ttfamily \#include $<$string$>$}\\*
{\ttfamily \#include $<$iostream$>$}\\*
{\ttfamily \#include $<$cstdio$>$}\\*
{\ttfamily \#include $<$netinet/in.\-h$>$}\\*
{\ttfamily \#include \char`\"{}Attribute\-Meter\-Factory.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Attribute\-Meter\-Registrar.\-h\char`\"{}}\\*
{\ttfamily \#include $<$boost/test/unit\-\_\-test.\-hpp$>$}\\*
{\ttfamily \#include \char`\"{}Logger.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}I\-Pv4\-Tuple.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Hasher.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Flow.\-h\char`\"{}}\\*
{\ttfamily \#include \char`\"{}Tcp\-Ipv4.\-h\char`\"{}}\\*
{\ttfamily \#include $<$regex$>$}\\*
Include dependency graph for test\-\_\-common.\-cpp\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__common_8cpp__incl}
\end{center}
\end{figure}
\subsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \hyperlink{test__common_8cpp_a6b2a3852db8bb19ab6909bac01859985}{B\-O\-O\-S\-T\-\_\-\-T\-E\-S\-T\-\_\-\-M\-O\-D\-U\-L\-E}~Vsid\-Common\-Test
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{_logger_8h_abb52531de0e96213782908cfd2dbd677}{I\-N\-I\-T\-\_\-\-L\-O\-G\-G\-I\-N\-G} int \hyperlink{test__common_8cpp_ad482e2dcf8bd7d1b991433945ad04918}{hex\-To\-Data} (const char $\ast$hex, unsigned char $\ast$$\ast$data)
\item 
\hyperlink{test__common_8cpp_aff3df067634bda01a2015ea7ebcd1de0}{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} (test\-\_\-tuple\-\_\-directions)
\item 
\hyperlink{test__common_8cpp_a73315cc5a676b12c8530d6c430fd8138}{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} (test\-\_\-tuple\-\_\-port\-\_\-change)
\item 
\hyperlink{test__common_8cpp_a0fd58dd9d097c4739d4baa2081c1a1cd}{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} (test\-\_\-tuple\-\_\-same\-\_\-ip)
\item 
\hyperlink{test__common_8cpp_a824ccc0522363a775be8e1458e731b38}{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} (tcp)
\item 
\hyperlink{test__common_8cpp_ab638b2986909cc50f26d2196414053de}{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} (regex)
\item 
\hyperlink{test__common_8cpp_a0a004b90e5b8e096142cce43b739c48e}{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E} (flow\-\_\-from\-\_\-ip)
\end{DoxyCompactItemize}


\subsection{Macro Definition Documentation}
\hypertarget{test__common_8cpp_a6b2a3852db8bb19ab6909bac01859985}{\index{test\-\_\-common.\-cpp@{test\-\_\-common.\-cpp}!B\-O\-O\-S\-T\-\_\-\-T\-E\-S\-T\-\_\-\-M\-O\-D\-U\-L\-E@{B\-O\-O\-S\-T\-\_\-\-T\-E\-S\-T\-\_\-\-M\-O\-D\-U\-L\-E}}
\index{B\-O\-O\-S\-T\-\_\-\-T\-E\-S\-T\-\_\-\-M\-O\-D\-U\-L\-E@{B\-O\-O\-S\-T\-\_\-\-T\-E\-S\-T\-\_\-\-M\-O\-D\-U\-L\-E}!test_common.cpp@{test\-\_\-common.\-cpp}}
\subsubsection[{B\-O\-O\-S\-T\-\_\-\-T\-E\-S\-T\-\_\-\-M\-O\-D\-U\-L\-E}]{\setlength{\rightskip}{0pt plus 5cm}\#define B\-O\-O\-S\-T\-\_\-\-T\-E\-S\-T\-\_\-\-M\-O\-D\-U\-L\-E~Vsid\-Common\-Test}}\label{test__common_8cpp_a6b2a3852db8bb19ab6909bac01859985}


Definition at line 9 of file test\-\_\-common.\-cpp.



\subsection{Function Documentation}
\hypertarget{test__common_8cpp_aff3df067634bda01a2015ea7ebcd1de0}{\index{test\-\_\-common.\-cpp@{test\-\_\-common.\-cpp}!B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}}
\index{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}!test_common.cpp@{test\-\_\-common.\-cpp}}
\subsubsection[{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}]{\setlength{\rightskip}{0pt plus 5cm}B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E (
\begin{DoxyParamCaption}
\item[{test\-\_\-tuple\-\_\-directions}]{}
\end{DoxyParamCaption}
)}}\label{test__common_8cpp_aff3df067634bda01a2015ea7ebcd1de0}


Definition at line 103 of file test\-\_\-common.\-cpp.


\begin{DoxyCode}
104 \{   
105     \hyperlink{_attribute_meter_registrar_8h_acc628170f0b90d7876378e03d3159647}{init\_attribute\_meters}();
106 
107     \hyperlink{class_vsid_common_1_1_i_pv4_tuple}{IPv4Tuple} ip\_tcp(169411074, 5555, 1499754872, 80, IPPROTO\_TCP);
108     \hyperlink{class_vsid_common_1_1_i_pv4_tuple}{IPv4Tuple} ip\_tcp\_opposite(1499754872, 80, 169411074, 5555, IPPROTO\_TCP);
109 
110     \hyperlink{class_vsid_common_1_1_ipv4_flow_hasher}{Ipv4FlowHasher} hasher;
111 
112     uint32\_t ip\_tcp\_hash = hasher(&ip\_tcp);
113     uint32\_t ip\_tcp\_opposite\_hash = hasher(&ip\_tcp\_opposite);
114 
115     BOOST\_CHECK\_EQUAL( ip\_tcp\_hash, ip\_tcp\_opposite\_hash );
116 
117 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__common_8cpp_aff3df067634bda01a2015ea7ebcd1de0_cgraph}
\end{center}
\end{figure}


\hypertarget{test__common_8cpp_a73315cc5a676b12c8530d6c430fd8138}{\index{test\-\_\-common.\-cpp@{test\-\_\-common.\-cpp}!B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}}
\index{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}!test_common.cpp@{test\-\_\-common.\-cpp}}
\subsubsection[{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}]{\setlength{\rightskip}{0pt plus 5cm}B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E (
\begin{DoxyParamCaption}
\item[{test\-\_\-tuple\-\_\-port\-\_\-change}]{}
\end{DoxyParamCaption}
)}}\label{test__common_8cpp_a73315cc5a676b12c8530d6c430fd8138}


Definition at line 119 of file test\-\_\-common.\-cpp.


\begin{DoxyCode}
120 \{   
121     \hyperlink{class_vsid_common_1_1_i_pv4_tuple}{IPv4Tuple} ip\_tcp(169411074, 5555, 1499754872, 80, IPPROTO\_TCP);
122     \hyperlink{class_vsid_common_1_1_i_pv4_tuple}{IPv4Tuple} ip\_tcp\_opposite(1499754872, 5555, 169411074, 80, IPPROTO\_TCP);
123 
124     \hyperlink{class_vsid_common_1_1_ipv4_flow_hasher}{Ipv4FlowHasher} hasher;
125 
126     uint32\_t ip\_tcp\_hash = hasher(&ip\_tcp);
127     uint32\_t ip\_tcp\_opposite\_hash = hasher(&ip\_tcp\_opposite);
128 
129     BOOST\_CHECK( ip\_tcp\_hash != ip\_tcp\_opposite\_hash );
130 
131 \}
\end{DoxyCode}
\hypertarget{test__common_8cpp_a0fd58dd9d097c4739d4baa2081c1a1cd}{\index{test\-\_\-common.\-cpp@{test\-\_\-common.\-cpp}!B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}}
\index{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}!test_common.cpp@{test\-\_\-common.\-cpp}}
\subsubsection[{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}]{\setlength{\rightskip}{0pt plus 5cm}B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E (
\begin{DoxyParamCaption}
\item[{test\-\_\-tuple\-\_\-same\-\_\-ip}]{}
\end{DoxyParamCaption}
)}}\label{test__common_8cpp_a0fd58dd9d097c4739d4baa2081c1a1cd}


Definition at line 133 of file test\-\_\-common.\-cpp.


\begin{DoxyCode}
134 \{   
135     \hyperlink{class_vsid_common_1_1_i_pv4_tuple}{IPv4Tuple} same\_ip\_tcp(1499754872, 5555, 1499754872, 80, IPPROTO\_TCP);
136     \hyperlink{class_vsid_common_1_1_i_pv4_tuple}{IPv4Tuple} same\_ip\_tcp\_opposite(1499754872, 80, 1499754872, 5555, IPPROTO\_TCP);
137 
138     \hyperlink{class_vsid_common_1_1_ipv4_flow_hasher}{Ipv4FlowHasher} hasher;
139 
140     uint32\_t same\_ip\_tcp\_hash = hasher(&same\_ip\_tcp);
141     uint32\_t same\_ip\_tcp\_opposite\_hash = hasher(&same\_ip\_tcp\_opposite);
142 
143     BOOST\_CHECK\_EQUAL( same\_ip\_tcp\_hash, same\_ip\_tcp\_opposite\_hash );
144 
145     \hyperlink{class_vsid_common_1_1_i_pv4_tuple}{IPv4Tuple} same\_ip\_udp(1499754872, 5555, 1499754872, 80, IPPROTO\_UDP);
146     \hyperlink{class_vsid_common_1_1_i_pv4_tuple}{IPv4Tuple} same\_ip\_udp\_opposite(1499754872, 80, 1499754872, 5555, IPPROTO\_UDP);
147 
148     uint32\_t same\_ip\_udp\_hash = hasher(&same\_ip\_udp);
149     uint32\_t same\_ip\_udp\_opposite\_hash = hasher(&same\_ip\_udp\_opposite);
150 
151     BOOST\_CHECK\_EQUAL( same\_ip\_udp\_hash, same\_ip\_udp\_opposite\_hash );
152     cout << \textcolor{stringliteral}{"udp ["} << same\_ip\_udp\_hash << \textcolor{stringliteral}{"] : tcp ["} << same\_ip\_tcp\_hash << \textcolor{stringliteral}{"]"} << endl;
153     BOOST\_CHECK( same\_ip\_udp\_hash != same\_ip\_tcp\_hash);
154 
155 \}
\end{DoxyCode}
\hypertarget{test__common_8cpp_a824ccc0522363a775be8e1458e731b38}{\index{test\-\_\-common.\-cpp@{test\-\_\-common.\-cpp}!B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}}
\index{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}!test_common.cpp@{test\-\_\-common.\-cpp}}
\subsubsection[{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}]{\setlength{\rightskip}{0pt plus 5cm}B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E (
\begin{DoxyParamCaption}
\item[{tcp}]{}
\end{DoxyParamCaption}
)}}\label{test__common_8cpp_a824ccc0522363a775be8e1458e731b38}


Definition at line 161 of file test\-\_\-common.\-cpp.


\begin{DoxyCode}
162 \{
163     timeval tv;
164 
165     \textcolor{comment}{// SYN packet}
166     \textcolor{keywordtype}{string} packetAsHex = \textcolor{stringliteral}{"
      4500003c065c40004006bcec0a0a0a8f4a7d185e9d6d01bb85f18d4800000000a00272101a9f0000020405b40402080a06668b140000000001030307"};
167     u\_char* packet;
168     \textcolor{keywordtype}{int} packetLen = \hyperlink{test__common_8cpp_ad482e2dcf8bd7d1b991433945ad04918}{hexToData}(packetAsHex.c\_str(), &packet);
169 
170     BOOST\_REQUIRE( packetLen > 0 );
171 
172     u\_char* tph = packet+\textcolor{keyword}{sizeof}(iphdr);
173     u\_char* data = tph + \textcolor{keyword}{sizeof}(tcphdr);
174 
175     \hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4} tcpPacket( packet, packetLen, packet, tph, data, tv);
176 
177     BOOST\_CHECK\_EQUAL( tcpPacket.version(), 4);
178     BOOST\_CHECK\_EQUAL( tcpPacket.protocol(), IPPROTO\_TCP);
179     BOOST\_CHECK\_EQUAL( ntohl(tcpPacket.srcIp()), 168430223);
180     BOOST\_CHECK\_EQUAL( ntohl(tcpPacket.dstIp()), 1249712222);
181     BOOST\_CHECK\_EQUAL( tcpPacket.srcPort(), 40301); 
182     BOOST\_CHECK\_EQUAL( tcpPacket.dstPort(), 443); 
183     BOOST\_CHECK\_EQUAL( tcpPacket.flags(), 0x02);
184 
185 
186     \textcolor{comment}{// data packet in opposite direction}
187     \textcolor{keywordtype}{string} oppAsHex = \textcolor{stringliteral}{"
      450005be300f00003106dcb74a7d185e0a0a0a8f01bb9d6d2a2d705f85f18e148010015580f8000001010
      80ae72e6c1506668b18160303004a020000460303558f061e8bb498e15dc190b8735fcf61ebb967475499f54f88fd3c60d6d3b05f00c
      02b00001e00000000ff01000100000b000403000102002300000010000500030268321603030e4e0b000e4a000e470006c9308206c53
      08205ada00302010202085735d4ddb82628fe300d06092a864886f70d01010b05003049310b300906035504061302555331133011060
      355040a130a476f6f676c6520496e63312530230603550403131c476f6f676c6520496e7465726e657420417574686f7269747920473
      2301e170d3135303631383039343333325a170d3135303931363030303030305a3066310b30090603550406130255533113301106035
      504080c0a43616c69666f726e69613116301406035504070c0d4d6f756e7461696e205669657731133011060355040a0c0a476f6f676
      c6520496e633115301306035504030c0c2a2e676f6f676c652e636f6d3059301306072a8648ce3d020106082a8648ce3d03010703420
      004aa22a75feb0281b6e25e7c5073930e638390958ed84573427276e98a6dd1512411bc29b25d11e5dea9cb080613b1e7177611edc0e
      e94de99cdce41c930a2ef48a382045d30820459301d0603551d250416301406082b0601050507030106082b060105050703023082032
      60603551d110482031d30820319820c2a2e676f6f676c652e636f6d820d2a2e616e64726f69642e636f6d82162a2e617070656e67696
      e652e676f6f676c652e636f6d82122a2e636c6f75642e676f6f676c652e636f6d82162a2e676f6f676c652d616e616c79746963732e6
      36f6d820b2a2e676f6f676c652e6361820b2a2e676f6f676c652e636c820e2a2e676f6f676c652e636f2e696e820e2a2e676f6f676c6
      52e636f2e6a70820e2a2e676f6f676c652e636f2e756b820f2a2e676f6f676c652e636f6d2e6172820f2a2e676f6f676c652e636f6d2
      e6175820f2a2e676f6f676c652e636f6d2e6272820f2a2e676f6f676c652e636f6d2e636f820f2a2e676f6f676c652e636f6d2e6d788
      20f2a2e676f6f676c652e636f6d2e7472820f2a2e676f6f676c652e636f6d2e766e820b2a2e676f6f676c652e6465820b2a2e676f6f6
      76c652e6573820b2a2e676f6f676c652e6672820b2a2e676f6f676c652e6875820b2a2e676f6f676c652e6974820b2a2e676f6f676c6
      52e6e6c820b2a2e676f6f676c652e706c820b2a2e676f6f676c652e707482122a2e676f6f676c656164617069732e636f6d820f2a2e6
      76f6f676c65617069732e636e82142a2e676f6f676c65636f6d6d657263652e636f6d82112a2e676f6f676c65766964656f2e636f6d8
      20c2a2e677374617469632e636e820d2a2e677374617469632e636f6d820a2a2e677674312e636f6d820a2a2e677674322e636f6d821
      42a2e6d65747269632e677374617469632e636f6d820c2a2e75726368696e2e636f6d82102a2e75726c2e676f6f676c652e636f6d821
      62a2e796f75747562652d6e6f636f6f6b69652e636f6d820d2a2e796f75747562652e636f6d82162a2e796f757475626565647563617
      4696f6e2e636f6d820b2a2e7974696d672e636f6d820b616e64726f69642e636f6d8204672e636f8206676f6f2e676c8214676f6f676
      c652d616e616c79746963732e636f6d820a676f6f676c652e636f6d8212676f6f676c65636f6d6d657263652e636f6d820a757263686
      96e2e636f6d8208796f7574752e6265820b796f75747562652e636f6d8214796f7574756265656475636174696f6e2e636f6d300b060
      3551d0f040403020780306806082b06010505070101045c305a302b06082b06010505073002861f687474703a2f2f706b692e676f6f6
      76c652e636f6d2f47494147322e637274302b06082b06010505073001861f687474703a2f2f636c69656e7473312e676f6f676c652e636f6d2f6f637370301d0603551d0e0416041400703b2f2c"};
188     u\_char* oppPacket;
189     \textcolor{keywordtype}{int} oppPacketLen = \hyperlink{test__common_8cpp_ad482e2dcf8bd7d1b991433945ad04918}{hexToData}(oppAsHex.c\_str(), &oppPacket);
190 
191     BOOST\_REQUIRE( oppPacketLen > 0 );
192 
193     tph = oppPacket+\textcolor{keyword}{sizeof}(iphdr);
194     data = tph + \textcolor{keyword}{sizeof}(tcphdr);
195 
196     \hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4} oppTcpPacket( oppPacket, oppPacketLen, oppPacket, tph, data, tv);
197 
198     BOOST\_CHECK\_EQUAL( oppTcpPacket.version(), 4);
199     BOOST\_CHECK\_EQUAL( oppTcpPacket.protocol(), IPPROTO\_TCP);
200     BOOST\_CHECK\_EQUAL( ntohl(oppTcpPacket.dstIp()), 168430223);
201     BOOST\_CHECK\_EQUAL( ntohl(oppTcpPacket.srcIp()), 1249712222);
202     BOOST\_CHECK\_EQUAL( oppTcpPacket.dstPort(), 40301); 
203     BOOST\_CHECK\_EQUAL( oppTcpPacket.srcPort(), 443); 
204     BOOST\_CHECK\_EQUAL( oppTcpPacket.flags(), 0x10);
205 
206 
207     BOOST\_CHECK\_EQUAL( tcpPacket.flowHash(), oppTcpPacket.flowHash());
208     BOOST\_CHECK( tcpPacket.sameFlow(oppTcpPacket));
209 
210     free(packet);
211     free(oppPacket);
212 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{test__common_8cpp_a824ccc0522363a775be8e1458e731b38_cgraph}
\end{center}
\end{figure}


\hypertarget{test__common_8cpp_ab638b2986909cc50f26d2196414053de}{\index{test\-\_\-common.\-cpp@{test\-\_\-common.\-cpp}!B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}}
\index{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}!test_common.cpp@{test\-\_\-common.\-cpp}}
\subsubsection[{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}]{\setlength{\rightskip}{0pt plus 5cm}B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E (
\begin{DoxyParamCaption}
\item[{regex}]{}
\end{DoxyParamCaption}
)}}\label{test__common_8cpp_ab638b2986909cc50f26d2196414053de}


Definition at line 214 of file test\-\_\-common.\-cpp.


\begin{DoxyCode}
215 \{
216     timeval tv;
217 
218     \textcolor{comment}{// SYN packet}
219     \textcolor{keywordtype}{string} packetAsHex = \textcolor{stringliteral}{"
      030000000000ba1400000000020007636f6e6e656374003ff000000000000003000361707002000676
      69657773730005746355726c02002872746d703a2f2f644e41652e736d6f6f746873747265616d732e74763a333636352f7669657773730004667061640100000c6361706162696c697469657300402e000000000000000b617564696f436f64656373"};
220     u\_char* packet;
221     \textcolor{keywordtype}{int} packetLen = \hyperlink{test__common_8cpp_ad482e2dcf8bd7d1b991433945ad04918}{hexToData}(packetAsHex.c\_str(), &packet);
222 
223     BOOST\_REQUIRE( packetLen > 0 );
224 
225     \textcolor{comment}{/*u\_char* packet = (u\_char*)"AAA";}
226 \textcolor{comment}{    int packetLen = strlen((const char*)packet);*/}
227     \hyperlink{_logger_8h_a6d6715d1fe8c64694de5f15913341dfa}{LOG\_HEXDUMP}(\textcolor{stringliteral}{"Packet :"}, packet, packetLen)
228 
229     BOOST\_REQUIRE (std::regex\_match ("subject", std::regex("(sub)(.*)") ));
230 
231     BOOST\_REQUIRE(std::regex\_match(packet, packet+packetLen, std::regex("\(\backslash\)x03.+\(\backslash\)x14.+\(\backslash\)x02.+\(\backslash\)x07.*(connect)\{
      0,1\}.+(app)\{0,1\}.+\textcolor{stringliteral}{")));//?.+(app)?"}) ));
232 
233    
234 
235    free(packet);
236 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{test__common_8cpp_ab638b2986909cc50f26d2196414053de_cgraph}
\end{center}
\end{figure}


\hypertarget{test__common_8cpp_a0a004b90e5b8e096142cce43b739c48e}{\index{test\-\_\-common.\-cpp@{test\-\_\-common.\-cpp}!B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}}
\index{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E@{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}!test_common.cpp@{test\-\_\-common.\-cpp}}
\subsubsection[{B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E}]{\setlength{\rightskip}{0pt plus 5cm}B\-O\-O\-S\-T\-\_\-\-A\-U\-T\-O\-\_\-\-T\-E\-S\-T\-\_\-\-C\-A\-S\-E (
\begin{DoxyParamCaption}
\item[{flow\-\_\-from\-\_\-ip}]{}
\end{DoxyParamCaption}
)}}\label{test__common_8cpp_a0a004b90e5b8e096142cce43b739c48e}


Definition at line 268 of file test\-\_\-common.\-cpp.


\begin{DoxyCode}
269 \{   
270     timeval tv;
271 
272     \textcolor{comment}{// SYN packet}
273     \textcolor{keywordtype}{string} packetAsHex = \textcolor{stringliteral}{"
      4500003c065c40004006bcec0a0a0a8f4a7d185e9d6d01bb85f18d4800000000a00272101a9f0000020405b40402080a06668b140000000001030307"};
274     u\_char* packet;
275     \textcolor{keywordtype}{int} packetLen = \hyperlink{test__common_8cpp_ad482e2dcf8bd7d1b991433945ad04918}{hexToData}(packetAsHex.c\_str(), &packet);
276 
277     BOOST\_REQUIRE( packetLen > 0 );
278 
279     u\_char* tph = packet+\textcolor{keyword}{sizeof}(iphdr);
280     u\_char* data = tph + \textcolor{keyword}{sizeof}(tcphdr);
281 
282     \hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4} tcpPacket( packet, packetLen, packet, tph, data, tv);
283 
284     \hyperlink{class_vsid_common_1_1_flow}{Flow} flow(&tcpPacket, NULL);
285     
286     \hyperlink{class_vsid_common_1_1_ipv4_flow_hasher}{Ipv4FlowHasher} hasher;
287 
288     uint32\_t ip\_tcp\_hash = hasher(&tcpPacket);
289 
290     BOOST\_CHECK\_EQUAL( ip\_tcp\_hash, flow.flowHash() );
291 
292     BOOST\_CHECK( flow.sameFlow(&tcpPacket) );
293 
294     \textcolor{comment}{//IPv4Tuple ip\_tcp\_opposite(1499754872, 80, 169411074, 5555, IPPROTO\_TCP);}
295 
296     \textcolor{comment}{//BOOST\_CHECK( flow.sameFlow(&ip\_tcp\_opposite) );}
297 
298     BOOST\_CHECK( flow.packetDirection(&tcpPacket) == Flow::Direction::ORIG\_TO\_DEST );
299     \textcolor{comment}{// /BOOST\_CHECK\_EQUAL( flow.packetDirection(&ip\_tcp\_opposite), Flow::DEST\_TO\_ORIG );}
300 \}  
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{test__common_8cpp_a0a004b90e5b8e096142cce43b739c48e_cgraph}
\end{center}
\end{figure}


\hypertarget{test__common_8cpp_ad482e2dcf8bd7d1b991433945ad04918}{\index{test\-\_\-common.\-cpp@{test\-\_\-common.\-cpp}!hex\-To\-Data@{hex\-To\-Data}}
\index{hex\-To\-Data@{hex\-To\-Data}!test_common.cpp@{test\-\_\-common.\-cpp}}
\subsubsection[{hex\-To\-Data}]{\setlength{\rightskip}{0pt plus 5cm}{\bf I\-N\-I\-T\-\_\-\-L\-O\-G\-G\-I\-N\-G} int hex\-To\-Data (
\begin{DoxyParamCaption}
\item[{const char $\ast$}]{hex, }
\item[{unsigned char $\ast$$\ast$}]{data}
\end{DoxyParamCaption}
)}}\label{test__common_8cpp_ad482e2dcf8bd7d1b991433945ad04918}


Definition at line 27 of file test\-\_\-common.\-cpp.


\begin{DoxyCode}
28 \{
29     \textcolor{comment}{// create the packet using hexdump from the test file}
30 
31     \textcolor{keywordflow}{if} (hex == NULL) \{
32         \textcolor{keywordflow}{return} -1;
33     \}
34     \textcolor{keywordtype}{int} first = 1;
35     \textcolor{keyword}{const} \textcolor{keywordtype}{char}* ch = hex;
36     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} c = 0;
37 
38     \textcolor{keywordtype}{int} len = strlen(hex);
39     \textcolor{keywordtype}{int} data\_len = 0;
40     *data = (uint8\_t*)malloc(len/2);
41     \textcolor{keywordtype}{char} *d\_p = (\textcolor{keywordtype}{char}*)*data;
42     \textcolor{keywordflow}{while} (ch && (ch-hex) < len) \{
43         \textcolor{keywordflow}{switch} (*ch) \{
44 
45             \textcolor{keywordflow}{case} \textcolor{charliteral}{' '}:  \textcolor{comment}{// space}
46             \textcolor{keywordflow}{case} \textcolor{charliteral}{'\(\backslash\)t'}: \textcolor{comment}{// tab}
47             \textcolor{keywordflow}{case} \textcolor{charliteral}{'\(\backslash\)n'}: \textcolor{comment}{// newline}
48                 \textcolor{comment}{// skip over}
49                 \textcolor{keywordflow}{break};
50 
51             \textcolor{keywordflow}{case} \textcolor{charliteral}{'1'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'2'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'3'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'4'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'5'}:
52             \textcolor{keywordflow}{case} \textcolor{charliteral}{'6'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'7'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'8'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'9'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'0'}:
53             \textcolor{keywordflow}{case} \textcolor{charliteral}{'a'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'b'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'c'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'d'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'e'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'f'}:
54             \textcolor{keywordflow}{case} \textcolor{charliteral}{'A'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'B'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'C'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'D'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'E'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'F'}:
55 
56                 \textcolor{keywordflow}{if} (*ch >= \textcolor{charliteral}{'0'} && *ch <= \textcolor{charliteral}{'9'}) \{
57                     c = (\textcolor{keywordtype}{unsigned} char) *ch - \textcolor{charliteral}{'0'};
58                 \} \textcolor{keywordflow}{else} \{ \textcolor{comment}{// must be hex letter}
59                     \textcolor{keywordflow}{switch} (*ch) \{
60                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'a'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'A'}: c = 0x0a; \textcolor{keywordflow}{break};
61                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'b'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'B'}: c = 0x0b; \textcolor{keywordflow}{break};
62                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'c'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'C'}: c = 0x0c; \textcolor{keywordflow}{break};
63                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'d'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'D'}: c = 0x0d; \textcolor{keywordflow}{break};
64                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'e'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'E'}: c = 0x0e; \textcolor{keywordflow}{break};
65                         \textcolor{keywordflow}{case} \textcolor{charliteral}{'f'}: \textcolor{keywordflow}{case} \textcolor{charliteral}{'F'}: c = 0x0f; \textcolor{keywordflow}{break};
66                     \}
67                 \}
68 
69                 \textcolor{keywordflow}{if} (first != 1) \{
70                     *d\_p = *d\_p | (c & 0x0f);
71                     first = 1;
72                     data\_len++;
73                     d\_p++; \textcolor{comment}{// move to next char}
74                 \} \textcolor{keywordflow}{else} \{
75                     *d\_p = c << 4;
76                     first = 0;
77                 \}
78                 \textcolor{keywordflow}{break};
79             \textcolor{keywordflow}{default}: \textcolor{comment}{// treat everything else as a comment and read till EOL}
80                 \textcolor{keywordflow}{while} (ch && *ch != \textcolor{charliteral}{'\(\backslash\)n'} && *ch != EOF && *ch != \textcolor{charliteral}{'\(\backslash\)0'}) \{
81                     ++ch;
82                     \textcolor{keywordflow}{if} (ch == NULL)
83                         \textcolor{keywordflow}{continue};
84                 \}
85                 \textcolor{keywordflow}{break};
86         \}
87         ++ch;
88     \}
89 
90     \textcolor{keywordflow}{if} (first != 1) \{
91         std::cout << \textcolor{stringliteral}{"Test::hexToData: ERROR: uneven number of chars in data"} << std::endl;
92         \textcolor{keywordflow}{return} -1;
93     \}
94 
95     \textcolor{keywordflow}{return} data\_len;
96 \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=330pt]{test__common_8cpp_ad482e2dcf8bd7d1b991433945ad04918_icgraph}
\end{center}
\end{figure}


