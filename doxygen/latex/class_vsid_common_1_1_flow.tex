\hypertarget{class_vsid_common_1_1_flow}{\section{Vsid\-Common\-:\-:Flow Class Reference}
\label{class_vsid_common_1_1_flow}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}
}


{\ttfamily \#include $<$Flow.\-h$>$}

\subsection*{Public Types}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781}{Direction} \{ \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a0d7777af293731f36e6d38a63c40c8d9}{Direction\-::\-O\-R\-I\-G\-\_\-\-T\-O\-\_\-\-D\-E\-S\-T}, 
\hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781acec4e9f5cd57d2a319a172cba0a6d505}{Direction\-::\-D\-E\-S\-T\-\_\-\-T\-O\-\_\-\-O\-R\-I\-G}, 
\hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a696b031073e74bf2cb98e5ef201d4aa3}{Direction\-::\-U\-N\-K\-N\-O\-W\-N}
 \}
\item 
enum \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2}{State} \{ \\*
\hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a24d459a81449d7210c8f9a86c2913034}{State\-::\-N\-E\-W}, 
\hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2afdb7bfdb2e03442a306fe07f152f91fc}{State\-::\-E\-S\-T\-A\-B\-L\-I\-S\-H\-I\-N\-G}, 
\hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7640f170af693e00a6c91df543aa2b76}{State\-::\-E\-S\-T\-A\-B\-L\-I\-S\-H\-E\-D}, 
\hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7a36ce282aeac424b9187eb19cf635c0}{State\-::\-F\-I\-N\-I\-S\-H\-I\-N\-G}, 
\\*
\hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}{State\-::\-F\-I\-N\-I\-S\-H\-E\-D}, 
\hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a055b500bb0ed82a58f138a885208507a}{State\-::\-F\-I\-N\-I\-S\-H\-E\-D\-\_\-\-N\-O\-T\-I\-F\-I\-E\-D}
 \}
\end{DoxyCompactItemize}
\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hyperlink{class_vsid_common_1_1_flow_a88a60ef6857c0b4dbcec4cc62828be6d}{Flow} (\hyperlink{class_vsid_common_1_1_i_pv4_packet}{I\-Pv4\-Packet} $\ast$packet, \hyperlink{class_vsid_1_1_protocol_model_db}{Vsid\-::\-Protocol\-Model\-Db} $\ast$database)
\item 
void \hyperlink{class_vsid_common_1_1_flow_a314bc25fad15a7a2b052dfda75cc3af6}{add\-Packet} (\hyperlink{class_vsid_common_1_1_i_pv4_packet}{I\-Pv4\-Packet} $\ast$packet)
\item 
const \hyperlink{class_vsid_common_1_1_i_pv4_tuple}{I\-Pv4\-Tuple} \& \hyperlink{class_vsid_common_1_1_flow_a832be3ee7521fdbba1072da2f0106fdf}{five\-Tuple} () const 
\item 
uint32\-\_\-t \hyperlink{class_vsid_common_1_1_flow_a25be552976420023b17052ee3b4d5bf6}{flow\-Hash} () const 
\item 
{\footnotesize template$<$typename T $>$ }\\bool \hyperlink{class_vsid_common_1_1_flow_a85284a063d691f0c54453695255fe6db}{same\-Flow} (const T $\ast$rhs) const 
\item 
{\footnotesize template$<$typename T $>$ }\\\hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781}{Direction} \hyperlink{class_vsid_common_1_1_flow_a8708e13cea69ad630274901ec94b5cf4}{packet\-Direction} (const T $\ast$rhs) const 
\item 
\hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2}{State} \hyperlink{class_vsid_common_1_1_flow_ac9ab4527fdac8cef6b1680b5c9e62015}{flow\-State} () const 
\item 
uint32\-\_\-t \hyperlink{class_vsid_common_1_1_flow_a41a3ebb168028d3cf0ea96b7e438ca89}{pkt\-Count} () const 
\item 
uint32\-\_\-t \hyperlink{class_vsid_common_1_1_flow_ab1640288592343532073bf506fc8a23e}{overall\-Pkt\-Count} () const 
\item 
const struct timeval \& \hyperlink{class_vsid_common_1_1_flow_a79a18af1103ad0571cbc4d7f27522274}{start\-Timestamp} () const 
\item 
const struct timeval \& \hyperlink{class_vsid_common_1_1_flow_af2613297a470084ea8c4731d42126389}{last\-Packet\-Timestamp} () const 
\item 
\hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781}{Direction} \hyperlink{class_vsid_common_1_1_flow_a3a2a19ce10910e74f43a196ab65f6cd9}{last\-Packet\-Direction} () const 
\item 
u\-\_\-char $\ast$ \hyperlink{class_vsid_common_1_1_flow_abbfbe66b1dc54b0ac83b029b052fb3e1}{first\-Orig\-To\-Dest\-Data} ()
\item 
size\-\_\-t \hyperlink{class_vsid_common_1_1_flow_aa722f9053c928770e90d689b5d517ec9}{first\-Orig\-To\-Dest\-Data\-Size} ()
\item 
bool \hyperlink{class_vsid_common_1_1_flow_ae437ae88fb48d6ac2880f40fc88195da}{is\-First\-Packet} ()
\item 
\hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781}{Direction} \hyperlink{class_vsid_common_1_1_flow_a0eb1c59e966ceb9ad6fee05d4c4784ad}{current\-Packet\-Direction} () const 
\item 
const std\-::vector\\*
$<$ std\-::shared\-\_\-ptr\\*
$<$ \hyperlink{class_vsid_1_1_attribute_meter}{Vsid\-::\-Attribute\-Meter} $>$ $>$ \& \hyperlink{class_vsid_common_1_1_flow_aa44a2ba1dfa16eee8f658e2ed7e0c1a4}{attribute\-Meters} ()
\item 
bool \hyperlink{class_vsid_common_1_1_flow_a47272e1d764ab23dee120592dd5010eb}{flow\-Classified} () const 
\item 
double \hyperlink{class_vsid_common_1_1_flow_a19a937ddd4c131b0576a5ff5ef558ec3}{classified\-Divergence} () const 
\item 
std\-::string \hyperlink{class_vsid_common_1_1_flow_a586c8f4c897090c7e133c5eee609dc77}{classified\-Protocol} () const 
\item 
double \hyperlink{class_vsid_common_1_1_flow_a1204dc8ab9fd2e9cc04a5d7118aa0bb1}{best\-Match\-Divergence} () const 
\item 
std\-::string \hyperlink{class_vsid_common_1_1_flow_ac209c90694eb55a4c2c93b0812f68080}{best\-Match\-Protocol} () const 
\item 
int \hyperlink{class_vsid_common_1_1_flow_a067c4a0fbf63c7295442c54898d9990d}{thread\-Queue\-Id} () const 
\item 
void \hyperlink{class_vsid_common_1_1_flow_a8bcd68ca197bf35b4655418ee72be9ad}{thread\-Queue\-Id} (int id)
\item 
void \hyperlink{class_vsid_common_1_1_flow_ab9d600f88c2db0a8a8faebe4cdfe5731}{inc\-Pkts\-In\-Queue} ()
\item 
void \hyperlink{class_vsid_common_1_1_flow_aa831199b27b8f9e73cb406f9a1bdcec5}{dec\-Pkts\-In\-Queue} ()
\item 
bool \hyperlink{class_vsid_common_1_1_flow_ae0497c1d26c120c088994fdb7643ead0}{have\-Pkts\-In\-Queue} ()
\item 
void \hyperlink{class_vsid_common_1_1_flow_a8deeaf4162dcc7ab1b3bfe43a60e30ec}{set\-Finished\-And\-Notified} ()
\end{DoxyCompactItemize}
\subsection*{Friends}
\begin{DoxyCompactItemize}
\item 
bool \hyperlink{class_vsid_common_1_1_flow_adf202422cece5e6dc6ad096f58c35b7c}{operator==} (const \hyperlink{class_vsid_common_1_1_flow}{Flow} \&lhs, const \hyperlink{class_vsid_common_1_1_flow}{Flow} \&rhs)
\item 
bool \hyperlink{class_vsid_common_1_1_flow_a8b8c36c44b03b0508540ba0c1db05e29}{operator!=} (const \hyperlink{class_vsid_common_1_1_flow}{Flow} \&lhs, const \hyperlink{class_vsid_common_1_1_flow}{Flow} \&rhs)
\end{DoxyCompactItemize}


\subsection{Detailed Description}


Definition at line 33 of file Flow.\-h.



\subsection{Member Enumeration Documentation}
\hypertarget{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!Direction@{Direction}}
\index{Direction@{Direction}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{Direction}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Vsid\-Common\-::\-Flow\-::\-Direction}\hspace{0.3cm}{\ttfamily [strong]}}}\label{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{O\-R\-I\-G\-\_\-\-T\-O\-\_\-\-D\-E\-S\-T@{O\-R\-I\-G\-\_\-\-T\-O\-\_\-\-D\-E\-S\-T}!Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!O\-R\-I\-G\-\_\-\-T\-O\-\_\-\-D\-E\-S\-T@{O\-R\-I\-G\-\_\-\-T\-O\-\_\-\-D\-E\-S\-T}}\item[{\em 
\hypertarget{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a0d7777af293731f36e6d38a63c40c8d9}{O\-R\-I\-G\-\_\-\-T\-O\-\_\-\-D\-E\-S\-T}\label{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a0d7777af293731f36e6d38a63c40c8d9}
}]\index{D\-E\-S\-T\-\_\-\-T\-O\-\_\-\-O\-R\-I\-G@{D\-E\-S\-T\-\_\-\-T\-O\-\_\-\-O\-R\-I\-G}!Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!D\-E\-S\-T\-\_\-\-T\-O\-\_\-\-O\-R\-I\-G@{D\-E\-S\-T\-\_\-\-T\-O\-\_\-\-O\-R\-I\-G}}\item[{\em 
\hypertarget{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781acec4e9f5cd57d2a319a172cba0a6d505}{D\-E\-S\-T\-\_\-\-T\-O\-\_\-\-O\-R\-I\-G}\label{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781acec4e9f5cd57d2a319a172cba0a6d505}
}]\index{U\-N\-K\-N\-O\-W\-N@{U\-N\-K\-N\-O\-W\-N}!Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!U\-N\-K\-N\-O\-W\-N@{U\-N\-K\-N\-O\-W\-N}}\item[{\em 
\hypertarget{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a696b031073e74bf2cb98e5ef201d4aa3}{U\-N\-K\-N\-O\-W\-N}\label{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a696b031073e74bf2cb98e5ef201d4aa3}
}]\end{description}
\end{Desc}


Definition at line 36 of file Flow.\-h.


\begin{DoxyCode}
37     \{
38         ORIG\_TO\_DEST,
39         DEST\_TO\_ORIG,
40         \hyperlink{namespace_vsid_training_a3bd76b3dc03035a8bde253556505b46aae9b392da625bf1bf9f2d738a4bc6bdb0}{UNKNOWN}
41     \};
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!State@{State}}
\index{State@{State}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{State}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf Vsid\-Common\-::\-Flow\-::\-State}\hspace{0.3cm}{\ttfamily [strong]}}}\label{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2}
\begin{Desc}
\item[Enumerator]\par
\begin{description}
\index{N\-E\-W@{N\-E\-W}!Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!N\-E\-W@{N\-E\-W}}\item[{\em 
\hypertarget{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a24d459a81449d7210c8f9a86c2913034}{N\-E\-W}\label{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a24d459a81449d7210c8f9a86c2913034}
}]\index{E\-S\-T\-A\-B\-L\-I\-S\-H\-I\-N\-G@{E\-S\-T\-A\-B\-L\-I\-S\-H\-I\-N\-G}!Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!E\-S\-T\-A\-B\-L\-I\-S\-H\-I\-N\-G@{E\-S\-T\-A\-B\-L\-I\-S\-H\-I\-N\-G}}\item[{\em 
\hypertarget{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2afdb7bfdb2e03442a306fe07f152f91fc}{E\-S\-T\-A\-B\-L\-I\-S\-H\-I\-N\-G}\label{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2afdb7bfdb2e03442a306fe07f152f91fc}
}]\index{E\-S\-T\-A\-B\-L\-I\-S\-H\-E\-D@{E\-S\-T\-A\-B\-L\-I\-S\-H\-E\-D}!Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!E\-S\-T\-A\-B\-L\-I\-S\-H\-E\-D@{E\-S\-T\-A\-B\-L\-I\-S\-H\-E\-D}}\item[{\em 
\hypertarget{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7640f170af693e00a6c91df543aa2b76}{E\-S\-T\-A\-B\-L\-I\-S\-H\-E\-D}\label{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7640f170af693e00a6c91df543aa2b76}
}]\index{F\-I\-N\-I\-S\-H\-I\-N\-G@{F\-I\-N\-I\-S\-H\-I\-N\-G}!Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!F\-I\-N\-I\-S\-H\-I\-N\-G@{F\-I\-N\-I\-S\-H\-I\-N\-G}}\item[{\em 
\hypertarget{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7a36ce282aeac424b9187eb19cf635c0}{F\-I\-N\-I\-S\-H\-I\-N\-G}\label{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7a36ce282aeac424b9187eb19cf635c0}
}]\index{F\-I\-N\-I\-S\-H\-E\-D@{F\-I\-N\-I\-S\-H\-E\-D}!Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!F\-I\-N\-I\-S\-H\-E\-D@{F\-I\-N\-I\-S\-H\-E\-D}}\item[{\em 
\hypertarget{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}{F\-I\-N\-I\-S\-H\-E\-D}\label{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}
}]\index{F\-I\-N\-I\-S\-H\-E\-D\-\_\-\-N\-O\-T\-I\-F\-I\-E\-D@{F\-I\-N\-I\-S\-H\-E\-D\-\_\-\-N\-O\-T\-I\-F\-I\-E\-D}!Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}}\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!F\-I\-N\-I\-S\-H\-E\-D\-\_\-\-N\-O\-T\-I\-F\-I\-E\-D@{F\-I\-N\-I\-S\-H\-E\-D\-\_\-\-N\-O\-T\-I\-F\-I\-E\-D}}\item[{\em 
\hypertarget{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a055b500bb0ed82a58f138a885208507a}{F\-I\-N\-I\-S\-H\-E\-D\-\_\-\-N\-O\-T\-I\-F\-I\-E\-D}\label{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a055b500bb0ed82a58f138a885208507a}
}]\end{description}
\end{Desc}


Definition at line 43 of file Flow.\-h.


\begin{DoxyCode}
44     \{
45         NEW,
46         ESTABLISHING, \textcolor{comment}{// For TCP really means in establishment}
47         ESTABLISHED,
48         FINISHING,
49         FINISHED,
50         FINISHED\_NOTIFIED
51     \};
\end{DoxyCode}


\subsection{Constructor \& Destructor Documentation}
\hypertarget{class_vsid_common_1_1_flow_a88a60ef6857c0b4dbcec4cc62828be6d}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!Flow@{Flow}}
\index{Flow@{Flow}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{Flow}]{\setlength{\rightskip}{0pt plus 5cm}Flow\-::\-Flow (
\begin{DoxyParamCaption}
\item[{{\bf I\-Pv4\-Packet} $\ast$}]{packet, }
\item[{{\bf Vsid\-::\-Protocol\-Model\-Db} $\ast$}]{database}
\end{DoxyParamCaption}
)}}\label{class_vsid_common_1_1_flow_a88a60ef6857c0b4dbcec4cc62828be6d}


Definition at line 29 of file Flow.\-cpp.


\begin{DoxyCode}
29                                                         :
30     \_hash(0),
31     \_pktCount(0),
32     \_overallPktCount(0),
33     \_flowState(\hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a24d459a81449d7210c8f9a86c2913034}{State::NEW}),
34     \_isFirstPacket(\textcolor{keyword}{false}),
35     \_flowClassified(\textcolor{keyword}{false}),
36     \_protocolModelDb(database),
37     \_classifiedDivergence(0),
38     \_bestMatchDivergence(100),
39     \_threadQueueId(-1),
40     \_pktsInQueue(0)
41 \{
42     \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a2db76e768086b4ac0aabfed850940c76}{src\_ip} = packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ab659b369af59b2745479e9080e0a0c54}{srcIp}();
43     \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a68b8ec74e1abb0d15ba66c48837a1662}{src\_port} = packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ad7f9c53e8a29a9ab3c87c28278ca7f5c}{srcPort}();
44     \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a21ace381c0b90771659095178d0f15af}{dst\_ip} = packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ac70c0e7771413d5d123d57c263bcde80}{dstIp}();
45     \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a1c1d101406314b12ce43cc1d54177736}{dst\_port} = packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_aa61f726412de0c644df127d2cd86ef64}{dstPort}();
46     \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a39c4c8ec9aaa3f80d17daaefb783beec}{transport} = packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ac1ff979633726d9f558bce1210595879}{protocol}();
47     \_startTimestamp = packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_abef9e70b733c8e5718153cb032ea6f1a}{timestamp}();
48     \_lastPacketTimestamp = packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_abef9e70b733c8e5718153cb032ea6f1a}{timestamp}();
49     \_firstOrigToDestDataSize = 0;
50     \_lastPacketDirection = \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a696b031073e74bf2cb98e5ef201d4aa3}{Direction::UNKNOWN};
51     \_currentPacketDirection = \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a696b031073e74bf2cb98e5ef201d4aa3}{Direction::UNKNOWN};
52 
53     \_attributeMeters = \hyperlink{class_vsid_1_1_attribute_meter_factory_a6cdacc430c359906c85ef36a7c6842fc}{Vsid::AttributeMeterFactory::instance}()->
      \hyperlink{class_vsid_1_1_attribute_meter_factory_ae44a5e19247998216c9e55112c790dea}{getAllMeters}();
54     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it = \_attributeMeters.begin(); it != \_attributeMeters.end(); ++it)
55     \{
56         \_attributeMetersMap[(*it)->name()] = (*it);
57     \}
58 
59     \hyperlink{class_vsid_common_1_1_ipv4_flow_hasher}{Ipv4FlowHasher} hasher;
60     \_hash = hasher(&\_firstPacketTuple);
61 \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a88a60ef6857c0b4dbcec4cc62828be6d_cgraph}
\end{center}
\end{figure}




\subsection{Member Function Documentation}
\hypertarget{class_vsid_common_1_1_flow_a314bc25fad15a7a2b052dfda75cc3af6}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!add\-Packet@{add\-Packet}}
\index{add\-Packet@{add\-Packet}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{add\-Packet}]{\setlength{\rightskip}{0pt plus 5cm}void Flow\-::add\-Packet (
\begin{DoxyParamCaption}
\item[{{\bf I\-Pv4\-Packet} $\ast$}]{packet}
\end{DoxyParamCaption}
)}}\label{class_vsid_common_1_1_flow_a314bc25fad15a7a2b052dfda75cc3af6}
Introduce some noise to make sure we treat all vectors

These are used to introduce noise into the K-\/\-L divergence to prevent divide by 0 issues

The reason is that for a K-\/\-L divergence to be valid it must satisfy 2 things Sum of all P(i) = 1 Sum of all Q(i) = 1 P(i) or Q(i) cannot be zero when the other has a value

Definition at line 63 of file Flow.\-cpp.


\begin{DoxyCode}
64 \{
65     \textcolor{comment}{// make sure the packet gets deleted.}
66     \textcolor{comment}{// If we later want to keep the packet we will release it from the ptr}
67     std::unique\_ptr<IPv4Packet> packetPtr(packet);
68 
69     \_overallPktCount++;
70     \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2}{State} stateUponArrival = \_flowState;
71     \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781}{Direction} tmpPktDirection = \hyperlink{class_vsid_common_1_1_flow_a8708e13cea69ad630274901ec94b5cf4}{packetDirection}(packet);
72 
73     \textcolor{comment}{/*if ( \_pktsInQueue > 1024 )}
74 \textcolor{comment}{    \{}
75 \textcolor{comment}{        if( !\_alarmedFlowSize )}
76 \textcolor{comment}{        \{}
77 \textcolor{comment}{            SLOG\_ERROR(<< "More than 1024 packets in flow queue [" << \_pktsInQueue << "]")}
78 \textcolor{comment}{        \}}
79 \textcolor{comment}{    \}}
80 \textcolor{comment}{    else}
81 \textcolor{comment}{    \{}
82 \textcolor{comment}{        \_alarmedFlowSize = false;}
83 \textcolor{comment}{    \}*/}
84 
85     \_isFirstPacket = \textcolor{keyword}{false};
86 
87     \textcolor{comment}{// TODO cleanup this to make it easier to understand and only do one cast}
88     \textcolor{keywordflow}{if} ( stateUponArrival == \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a24d459a81449d7210c8f9a86c2913034}{Flow::State::NEW} )
89     \{
90         \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2afdb7bfdb2e03442a306fe07f152f91fc}{Flow::State::ESTABLISHING};
91 
92         \textcolor{keywordflow}{if}( packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ac1ff979633726d9f558bce1210595879}{protocol}() == IPPROTO\_UDP )
93         \{
94             \_firstOrigToDestDataSize = (\hyperlink{_flow_8h_a3850e13d81280c9383e0b2a20eaebaeb}{PACKET\_MAX\_BUFFER\_SIZE} < packet->
      \hyperlink{class_vsid_common_1_1_i_pv4_packet_a39fe36210895625ee87320f5c0c7f52e}{dataSize}()) ? \hyperlink{_flow_8h_a3850e13d81280c9383e0b2a20eaebaeb}{PACKET\_MAX\_BUFFER\_SIZE} : packet->
      \hyperlink{class_vsid_common_1_1_i_pv4_packet_a39fe36210895625ee87320f5c0c7f52e}{dataSize}();
95             memcpy(\_firstOrigToDestData, packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_a9fb8c763d740e193a68c55604a8a7bd6}{data}(), \_firstOrigToDestDataSize);
96             \_isFirstPacket = \textcolor{keyword}{true};
97             \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"Got first packet "} << *\textcolor{keyword}{this});
98         \}
99         \textcolor{keywordflow}{else} \textcolor{comment}{// TCP}
100         \{
101             \hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}* tcpPacket = \textcolor{keyword}{static\_cast<}\hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}*\textcolor{keyword}{>}(packet);
102             uint8\_t flags = tcpPacket->\hyperlink{class_vsid_common_1_1_tcp_i_pv4_adb5c52a0772cf3bd53c41702b877b7d1}{flags}();
103 
104             \textcolor{keywordflow}{if}( (flags & TH\_FIN) || flags & TH\_RST )
105             \{
106                 \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}{Flow::State::FINISHED};
107                 \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"RST or FIN in NEW state returning"})
108                 packet->setVerdict();
109                 return;
110             \}
111             else if( (flags & TH\_SYN) == false)
112             \{
113                 \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"not a syn : datasize "} << packet->
      \hyperlink{class_vsid_common_1_1_i_pv4_packet_a39fe36210895625ee87320f5c0c7f52e}{dataSize}() );
114                 
115                 \textcolor{comment}{/*}
116 \textcolor{comment}{                if( (flags & TH\_ACK) && packet->dataSize() == 0)}
117 \textcolor{comment}{                \{   }
118 \textcolor{comment}{                    // ACK and empty packet on NEW. Consider it finished}
119 \textcolor{comment}{                    \_flowState = Flow::State::FINISHED;}
120 \textcolor{comment}{                \}}
121 \textcolor{comment}{                else}
122 \textcolor{comment}{                \{}
123 \textcolor{comment}{                    // new flow where we didn't see SYN?}
124 \textcolor{comment}{                    \_firstOrigToDestDataSize = (PACKET\_MAX\_BUFFER\_SIZE < packet->dataSize()) ?
       PACKET\_MAX\_BUFFER\_SIZE : packet->dataSize();}
125 \textcolor{comment}{                    memcpy(\_firstOrigToDestData, packet->data(), \_firstOrigToDestDataSize);}
126 \textcolor{comment}{                    \_isFirstPacket = true;}
127 \textcolor{comment}{                    SLOG\_INFO(<< "Got first packet " << *this);}
128 \textcolor{comment}{                \}}
129 \textcolor{comment}{                */}
130             
131                 \textcolor{comment}{// For now only support TCP flows where we have seen the SYN}
132                 \textcolor{comment}{// Once we have a better TCP state machine we can support partial flows}
133                 \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}{Flow::State::FINISHED};
134             \}
135         \}
136     \}
137     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( stateUponArrival == \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2afdb7bfdb2e03442a306fe07f152f91fc}{Flow::State::ESTABLISHING})
138     \{
139         \textcolor{comment}{// this is rather naive for TCP but will leave for now}
140         \textcolor{keywordflow}{if}( packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ac1ff979633726d9f558bce1210595879}{protocol}() == IPPROTO\_UDP )
141         \{
142             \textcolor{keywordflow}{if}( tmpPktDirection == \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781acec4e9f5cd57d2a319a172cba0a6d505}{Direction::DEST\_TO\_ORIG} )
143             \{
144                 \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7640f170af693e00a6c91df543aa2b76}{Flow::State::ESTABLISHED};
145             \}
146         \}
147         \textcolor{keywordflow}{else}
148         \{
149             \hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}* tcpPacket = \textcolor{keyword}{static\_cast<}\hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}*\textcolor{keyword}{>}(packet);
150             uint8\_t flags = tcpPacket->\hyperlink{class_vsid_common_1_1_tcp_i_pv4_adb5c52a0772cf3bd53c41702b877b7d1}{flags}();
151 
152             \textcolor{keywordflow}{if}( (flags & TH\_FIN) || flags & TH\_RST )
153             \{
154                 \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}{Flow::State::FINISHED};
155                 \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"RST or FIN in ESTABLISHING state returning"})
156                 packet->setVerdict();
157                 return;
158             \}
159             else if ( flags & TH\_SYN ) \textcolor{comment}{// TODO maybe make this a syn ack check}
160             \{
161                 \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2afdb7bfdb2e03442a306fe07f152f91fc}{Flow::State::ESTABLISHING};
162             \}
163             \textcolor{keywordflow}{else} 
164             \{
165                 \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7640f170af693e00a6c91df543aa2b76}{Flow::State::ESTABLISHED};
166             \}
167         \}
168     \}
169     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( stateUponArrival == \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7640f170af693e00a6c91df543aa2b76}{Flow::State::ESTABLISHED} )
170     \{
171         \textcolor{keywordflow}{if}( packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ac1ff979633726d9f558bce1210595879}{protocol}() == IPPROTO\_TCP )
172         \{
173             \hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}* tcpPacket = \textcolor{keyword}{static\_cast<}\hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}*\textcolor{keyword}{>}(packet);
174             uint8\_t flags = tcpPacket->\hyperlink{class_vsid_common_1_1_tcp_i_pv4_adb5c52a0772cf3bd53c41702b877b7d1}{flags}();
175 
176             \textcolor{keywordflow}{if}( (flags & TH\_FIN) )
177             \{
178                 \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}{Flow::State::FINISHED};
179                 \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{" Flow entering Finished state"});
180                 packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ae314f9e085588928d3c260211f80da87}{setVerdict}();
181                 \textcolor{keywordflow}{return};
182             \}
183             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( flags & TH\_RST )
184             \{
185                 \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}{Flow::State::FINISHED};
186                 \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{" Flow entering Finished state"});
187                 packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ae314f9e085588928d3c260211f80da87}{setVerdict}();
188                 \textcolor{keywordflow}{return};
189             \}
190             \textcolor{keywordflow}{else}
191             \{
192                 \textcolor{keywordflow}{if}( \_firstOrigToDestDataSize == 0 && tmpPktDirection == 
      \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a0d7777af293731f36e6d38a63c40c8d9}{Direction::ORIG\_TO\_DEST})
193                 \{
194                     \textcolor{comment}{// First data packet after SYN / ACK}
195                     \_firstOrigToDestDataSize = (\hyperlink{_flow_8h_a3850e13d81280c9383e0b2a20eaebaeb}{PACKET\_MAX\_BUFFER\_SIZE} < packet->
      \hyperlink{class_vsid_common_1_1_i_pv4_packet_a39fe36210895625ee87320f5c0c7f52e}{dataSize}()) ? \hyperlink{_flow_8h_a3850e13d81280c9383e0b2a20eaebaeb}{PACKET\_MAX\_BUFFER\_SIZE} : packet->
      \hyperlink{class_vsid_common_1_1_i_pv4_packet_a39fe36210895625ee87320f5c0c7f52e}{dataSize}();
196                     memcpy(\_firstOrigToDestData, packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_a9fb8c763d740e193a68c55604a8a7bd6}{data}(), \_firstOrigToDestDataSize);
197                     \_isFirstPacket = \textcolor{keyword}{true};
198                     \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"Got first packet "} << *\textcolor{keyword}{this});
199                 \}
200             \}
201         \}
202     \}
203     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( stateUponArrival == \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a7a36ce282aeac424b9187eb19cf635c0}{Flow::State::FINISHING} )
204     \{
205         \textcolor{keywordflow}{if}( packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ac1ff979633726d9f558bce1210595879}{protocol}() == IPPROTO\_TCP )
206         \{
207             \hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}* tcpPacket = \textcolor{keyword}{static\_cast<}\hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}*\textcolor{keyword}{>}(packet);
208             uint8\_t flags = tcpPacket->\hyperlink{class_vsid_common_1_1_tcp_i_pv4_adb5c52a0772cf3bd53c41702b877b7d1}{flags}();
209 
210             \textcolor{keywordflow}{if}( (flags & TH\_FIN) || flags & TH\_RST )
211             \{
212                 \_flowState = \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}{Flow::State::FINISHED};
213                 \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{" Flow entering Finished state"});
214                 packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ae314f9e085588928d3c260211f80da87}{setVerdict}();
215                 \textcolor{keywordflow}{return};
216             \}
217         \}
218     \}
219     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( stateUponArrival == \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a2c616b2713e2e0aed04b4c4752c88133}{Flow::State::FINISHED} )
220     \{
221         \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{" Flow already Finished"});
222         \textcolor{comment}{// Flow already fisinhed ??}
223         packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ae314f9e085588928d3c260211f80da87}{setVerdict}();
224         \textcolor{keywordflow}{return};
225     \}
226     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( stateUponArrival == \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a055b500bb0ed82a58f138a885208507a}{Flow::State::FINISHED\_NOTIFIED})
227     \{
228         \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"Flow already finisned and notified"})
229         packet->setVerdict();
230         return;
231     \}
232 
233 
234 
235 
236     \textcolor{comment}{// Check if we consider it a "Data Packet"}
237     if( packet->protocol() == IPPROTO\_TCP )
238     \{
239         \hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}* tcpPacket = \textcolor{keyword}{static\_cast<}\hyperlink{class_vsid_common_1_1_tcp_i_pv4}{TcpIPv4}*\textcolor{keyword}{>}(packet);
240 
241         \textcolor{comment}{// No need to analyse a SYN packet}
242         \textcolor{keywordflow}{if} ( (tcpPacket->\hyperlink{class_vsid_common_1_1_tcp_i_pv4_adb5c52a0772cf3bd53c41702b877b7d1}{flags}() & TH\_SYN) && tcpPacket->\hyperlink{class_vsid_common_1_1_i_pv4_packet_a39fe36210895625ee87320f5c0c7f52e}{dataSize}() <= 0 )
243         \{
244             \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"TCP SYN with no data"})
245             packet->setVerdict();
246             \textcolor{comment}{//\_lastPacketTimestamp = packet->timestamp();}
247             return;
248         \}
249 
250         \textcolor{comment}{// Don't bother to analyse an empty TCP ACK packets}
251         if ( (tcpPacket->flags() & TH\_ACK) && tcpPacket->dataSize() <= 0 )
252         \{
253             \textcolor{comment}{//\_lastPacketTimestamp = packet->timestamp();}
254             \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"TCP Ack with no data"})
255             packet->setVerdict();
256             return;
257         \}
258     \} 
259     
260     \textcolor{comment}{// Update these because we use these only for "Data" packets on a flow}
261     \_pktCount++;
262     \_lastPacketDirection = \_currentPacketDirection;
263     \_currentPacketDirection = tmpPktDirection;
264 
265     if( \_flowClassified )
266     \{
267         \_lastPacketTimestamp = packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_abef9e70b733c8e5718153cb032ea6f1a}{timestamp}();
268         \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{" Flow already classified"});
269         packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ae314f9e085588928d3c260211f80da87}{setVerdict}();
270         \textcolor{comment}{// Already classified. Don't waste time updating calculations}
271         \textcolor{keywordflow}{return};
272     \}
273 
274     \textcolor{keywordflow}{if}( \_pktCount > \_protocolModelDb->\hyperlink{class_vsid_1_1_protocol_model_db_a2df8e380ce56c8509007df98fce27d09}{cutoffLimit}() )
275     \{
276         \_lastPacketTimestamp = packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_abef9e70b733c8e5718153cb032ea6f1a}{timestamp}();
277         \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{" Flow above cutoffLimit "} << \_protocolModelDb->
      \hyperlink{class_vsid_1_1_protocol_model_db_a2df8e380ce56c8509007df98fce27d09}{cutoffLimit}() 
278                         << \textcolor{stringliteral}{" : "} << \_pktCount );
279         packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ae314f9e085588928d3c260211f80da87}{setVerdict}();
280         \textcolor{comment}{// Don't look at packet because it is over the limit}
281         \textcolor{keywordflow}{return};
282     \}
283 
284     \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}( << \textcolor{stringliteral}{"Calculating packet "});
285     \textcolor{keywordflow}{for}(\textcolor{keyword}{auto} it = \_attributeMeters.begin(); it != \_attributeMeters.end(); ++it)
286     \{
287         \textcolor{keywordflow}{try}
288         \{
289             \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}( << \textcolor{stringliteral}{"Calculating "} << (*it)->name());
290             (*it)->calculateMeasurement(\textcolor{keyword}{this}, packet);
291         \}
292         \textcolor{keywordflow}{catch}(std::exception& ex)
293         \{
294             \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}( << \textcolor{stringliteral}{"Exception caught calculation ["} << (*it)->name() << \textcolor{stringliteral}{"] : ["}
295                             << ex.what() << \textcolor{stringliteral}{"]"});
296         \}
297     \}
298 
299     \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}( << \textcolor{stringliteral}{"Meters updated"})
300     \_lastPacketTimestamp = packet->timestamp();
301 
302     if( !\hyperlink{class_vsid_common_1_1_common_config}{CommonConfig}::instance()->learningMode() && !\_flowClassified )
303     \{
304         \hyperlink{_logger_8h_a1eb7292acb79b8ddab9851b3a9f7a4da}{SLOG\_DEBUG}(<< \textcolor{stringliteral}{"Calculating K-L Divergence"})
305         \textcolor{comment}{// TODO Calculate K-L Divergence}
306         for(\textcolor{keywordtype}{size\_t} i = 0; i < \_protocolModelDb->size(); i++)
307         \{
308             \textcolor{keywordtype}{double} klDivergence = 0.0;
309 
310             \textcolor{comment}{// get protocol model in order or dst port of flow}
311             uint16\_t hintPort = 0;
312             \textcolor{keywordflow}{if}(\hyperlink{class_vsid_common_1_1_common_config_a69c29458a786be527fe66470ac9fbbdb}{CommonConfig::instance}()->usePortHints())
313                 hintPort = \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a1c1d101406314b12ce43cc1d54177736}{dst\_port};
314 
315             std::shared\_ptr<ProtocolModel> pm = \_protocolModelDb->\hyperlink{class_vsid_1_1_protocol_model_db_a5bc72492cdde09f1bf753e0ebee26e9e}{at}(i, hintPort);
316 
317             \textcolor{keywordflow}{if}( !pm )
318             \{
319                 \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}(<< \textcolor{stringliteral}{"Unable to get protocol model"});
320                 \textcolor{keywordflow}{continue};
321             \}
322 
323             \textcolor{keywordflow}{if}( ! pm->enabled() )
324             \{
325                 \hyperlink{_logger_8h_a1eb7292acb79b8ddab9851b3a9f7a4da}{SLOG\_DEBUG}(<< \textcolor{stringliteral}{"PRotocol ["} << pm->name() << \textcolor{stringliteral}{"] disabled"})
326                 \textcolor{keywordflow}{continue};
327             \}
328 
329             \hyperlink{_logger_8h_a1eb7292acb79b8ddab9851b3a9f7a4da}{SLOG\_DEBUG}(<< \textcolor{stringliteral}{"Checking model "} << pm->name());
330             \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} attr = 0; attr < pm->size(); attr++)
331             \{
332                 std::shared\_ptr<AttributeMeter> pm\_am = pm->at(attr);
333                 \textcolor{keywordflow}{if}( !pm\_am->enabled() )
334                     \textcolor{keywordflow}{continue};
335 
336                 std::shared\_ptr<AttributeMeter> am = \_attributeMetersMap[pm\_am->name()];
337 
338                 \textcolor{keywordtype}{double} sum = 0.0;
339 
340                 \textcolor{keywordtype}{double} pm\_am\_sum = 0;
341                 \textcolor{keywordtype}{double} am\_sum = 0;
342 
343                 \textcolor{keywordflow}{for}(\textcolor{keywordtype}{size\_t} fp = 0; fp < pm\_am->size(); ++fp)
344                 \{
356                     \textcolor{keywordtype}{double} am\_fp = (am->at(fp) * am->klFixMultiplier()) + am->klFixIncrement();
357                     \textcolor{keywordtype}{double} pm\_am\_fp = (pm\_am->at(fp) * pm\_am->klFixMultiplier()) + pm\_am->klFixIncrement();
358 
359                     am\_sum += am\_fp;
360                     pm\_am\_sum += pm\_am\_fp;
361 
362                     \textcolor{keywordflow}{if}(pm\_am\_fp > (\textcolor{keywordtype}{double})0)
363                     \{   
364                         sum += am\_fp * log2(am\_fp / pm\_am\_fp);
365                         \textcolor{comment}{//SLOG\_INFO(<<" K-L sum is " << sum);}
366                     \}
367                     \textcolor{keywordflow}{else}
368                     \{
369                         \hyperlink{_logger_8h_a2a8694cd392d18f4db6b9cc9f15bafe3}{SLOG\_ERROR}(<< \textcolor{stringliteral}{"pm\_am\_fp is 0"})
370                     \}
371 
372                     
373                 \}
374                 \textcolor{keywordflow}{if}( sum < (\textcolor{keywordtype}{double})0.0 )
375                 \{
376                     sum *= -1;
377                 \}
378 
379                 \hyperlink{_logger_8h_a1eb7292acb79b8ddab9851b3a9f7a4da}{SLOG\_DEBUG}(<< \textcolor{stringliteral}{"Sum for "} << pm\_am->name() << \textcolor{stringliteral}{" is "} << sum);
380                 klDivergence += sum;
381             \}
382 
383 
384             \textcolor{comment}{// We will only do a full classification if we have more than the defining Limit worth}
385             \textcolor{comment}{// of packets}
386             \textcolor{keywordflow}{if}( klDivergence > 0 
387                     &&\_pktCount >= \_protocolModelDb->\hyperlink{class_vsid_1_1_protocol_model_db_a511e5fdf67995099e81175a6d34d1aac}{definingLimit}() 
388                     && klDivergence < \hyperlink{class_vsid_common_1_1_common_config_a69c29458a786be527fe66470ac9fbbdb}{CommonConfig::instance}()->
      \hyperlink{class_vsid_common_1_1_common_config_ac08bbad3a85c8ba4e43a591f7f02fe06}{divergenceThreshold}() )
389             \{
390                 \_flowClassified = \textcolor{keyword}{true};
391                 \_classifiedProtocol = pm->name();
392                 \_classifiedDivergence = klDivergence;
393                 \hyperlink{_logger_8h_a1eb7292acb79b8ddab9851b3a9f7a4da}{SLOG\_DEBUG}(<< \textcolor{stringliteral}{"Flow classified as ["} << \_classifiedProtocol 
394                             << \textcolor{stringliteral}{"] with divergence ["} << \_classifiedDivergence 
395                             << \textcolor{stringliteral}{"] : "} << *\textcolor{keyword}{this});
396                 \textcolor{keywordflow}{break};
397             \}
398             
399 
400             \textcolor{keywordflow}{if}( klDivergence > 0 
401                 \textcolor{comment}{//&&\_pktCount >= \_protocolModelDb->definingLimit()}
402                 && klDivergence < \_bestMatchDivergence )
403             \{
404                 \_bestMatchDivergence = klDivergence;
405                 \_bestMatchProtocol = pm->name();
406                 \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"Updating best match as ["} << \_bestMatchDivergence 
407                                 << \textcolor{stringliteral}{"] with divergence ["} << \_bestMatchProtocol 
408                                 << \textcolor{stringliteral}{"] : "} << *\textcolor{keyword}{this});
409             \}
410  
411             \hyperlink{_logger_8h_a1eb7292acb79b8ddab9851b3a9f7a4da}{SLOG\_DEBUG}(<< \textcolor{stringliteral}{"K-L Divergence for ["} << pm->name() <<\textcolor{stringliteral}{"] is ["} << klDivergence <<\textcolor{stringliteral}{"] on
       flow ["} << *\textcolor{keyword}{this} << \textcolor{stringliteral}{"]"});
412             
413         \}
414 
415         \textcolor{keywordflow}{if} (\hyperlink{class_vsid_common_1_1_common_config_a69c29458a786be527fe66470ac9fbbdb}{CommonConfig::instance}()->\hyperlink{class_vsid_common_1_1_common_config_a459340bb4e0af6a87ab79a50f0467776}{useBestMatch}())
416         \{
417             \textcolor{keywordflow}{if}( !\_flowClassified 
418                     && \_pktCount == \_protocolModelDb->\hyperlink{class_vsid_1_1_protocol_model_db_a511e5fdf67995099e81175a6d34d1aac}{definingLimit}() 
419                     && \_bestMatchDivergence < \hyperlink{class_vsid_common_1_1_common_config_a69c29458a786be527fe66470ac9fbbdb}{CommonConfig::instance}()->
      \hyperlink{class_vsid_common_1_1_common_config_ac08bbad3a85c8ba4e43a591f7f02fe06}{divergenceThreshold}() )
420             \{
421                 \_flowClassified = \textcolor{keyword}{true};
422                 \_classifiedProtocol = \_bestMatchProtocol;
423                 \_classifiedDivergence = \_bestMatchDivergence;
424                 \hyperlink{_logger_8h_a1eb7292acb79b8ddab9851b3a9f7a4da}{SLOG\_DEBUG}(<< \textcolor{stringliteral}{"Flow classified (BM) as ["} << \_classifiedProtocol 
425                             << \textcolor{stringliteral}{"] with divergence ["} << \_classifiedDivergence 
426                             << \textcolor{stringliteral}{"] : "} << *\textcolor{keyword}{this});
427             \}
428         \}
429     \}
430 
431     packet->\hyperlink{class_vsid_common_1_1_i_pv4_packet_ae314f9e085588928d3c260211f80da87}{setVerdict}();
432 
433 \}\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{class_vsid_common_1_1_flow_a314bc25fad15a7a2b052dfda75cc3af6_cgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_common_1_1_flow_aa44a2ba1dfa16eee8f658e2ed7e0c1a4}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!attribute\-Meters@{attribute\-Meters}}
\index{attribute\-Meters@{attribute\-Meters}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{attribute\-Meters}]{\setlength{\rightskip}{0pt plus 5cm}const std\-::vector$<$std\-::shared\-\_\-ptr$<${\bf Vsid\-::\-Attribute\-Meter}$>$ $>$\& Vsid\-Common\-::\-Flow\-::attribute\-Meters (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_aa44a2ba1dfa16eee8f658e2ed7e0c1a4}


Definition at line 196 of file Flow.\-h.


\begin{DoxyCode}
196 \{ \textcolor{keywordflow}{return} \_attributeMeters; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a1204dc8ab9fd2e9cc04a5d7118aa0bb1}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!best\-Match\-Divergence@{best\-Match\-Divergence}}
\index{best\-Match\-Divergence@{best\-Match\-Divergence}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{best\-Match\-Divergence}]{\setlength{\rightskip}{0pt plus 5cm}double Vsid\-Common\-::\-Flow\-::best\-Match\-Divergence (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a1204dc8ab9fd2e9cc04a5d7118aa0bb1}


Definition at line 202 of file Flow.\-h.


\begin{DoxyCode}
202 \{ \textcolor{keywordflow}{return} \_bestMatchDivergence; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_ac209c90694eb55a4c2c93b0812f68080}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!best\-Match\-Protocol@{best\-Match\-Protocol}}
\index{best\-Match\-Protocol@{best\-Match\-Protocol}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{best\-Match\-Protocol}]{\setlength{\rightskip}{0pt plus 5cm}std\-::string Vsid\-Common\-::\-Flow\-::best\-Match\-Protocol (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_ac209c90694eb55a4c2c93b0812f68080}


Definition at line 203 of file Flow.\-h.


\begin{DoxyCode}
203 \{ \textcolor{keywordflow}{return} \_bestMatchProtocol; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a19a937ddd4c131b0576a5ff5ef558ec3}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!classified\-Divergence@{classified\-Divergence}}
\index{classified\-Divergence@{classified\-Divergence}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{classified\-Divergence}]{\setlength{\rightskip}{0pt plus 5cm}double Vsid\-Common\-::\-Flow\-::classified\-Divergence (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a19a937ddd4c131b0576a5ff5ef558ec3}


Definition at line 199 of file Flow.\-h.


\begin{DoxyCode}
199 \{ \textcolor{keywordflow}{return} \_classifiedDivergence; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a586c8f4c897090c7e133c5eee609dc77}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!classified\-Protocol@{classified\-Protocol}}
\index{classified\-Protocol@{classified\-Protocol}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{classified\-Protocol}]{\setlength{\rightskip}{0pt plus 5cm}std\-::string Vsid\-Common\-::\-Flow\-::classified\-Protocol (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a586c8f4c897090c7e133c5eee609dc77}


Definition at line 200 of file Flow.\-h.


\begin{DoxyCode}
200 \{ \textcolor{keywordflow}{return} \_classifiedProtocol; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a0eb1c59e966ceb9ad6fee05d4c4784ad}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!current\-Packet\-Direction@{current\-Packet\-Direction}}
\index{current\-Packet\-Direction@{current\-Packet\-Direction}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{current\-Packet\-Direction}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Direction} Vsid\-Common\-::\-Flow\-::current\-Packet\-Direction (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a0eb1c59e966ceb9ad6fee05d4c4784ad}
Direction of the current packet in the flow \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 194 of file Flow.\-h.


\begin{DoxyCode}
194 \{ \textcolor{keywordflow}{return} \_currentPacketDirection; \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a0eb1c59e966ceb9ad6fee05d4c4784ad_icgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_common_1_1_flow_aa831199b27b8f9e73cb406f9a1bdcec5}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!dec\-Pkts\-In\-Queue@{dec\-Pkts\-In\-Queue}}
\index{dec\-Pkts\-In\-Queue@{dec\-Pkts\-In\-Queue}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{dec\-Pkts\-In\-Queue}]{\setlength{\rightskip}{0pt plus 5cm}void Vsid\-Common\-::\-Flow\-::dec\-Pkts\-In\-Queue (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_aa831199b27b8f9e73cb406f9a1bdcec5}


Definition at line 213 of file Flow.\-h.


\begin{DoxyCode}
213 \{ \_pktsInQueue--; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_abbfbe66b1dc54b0ac83b029b052fb3e1}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!first\-Orig\-To\-Dest\-Data@{first\-Orig\-To\-Dest\-Data}}
\index{first\-Orig\-To\-Dest\-Data@{first\-Orig\-To\-Dest\-Data}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{first\-Orig\-To\-Dest\-Data}]{\setlength{\rightskip}{0pt plus 5cm}u\-\_\-char$\ast$ Vsid\-Common\-::\-Flow\-::first\-Orig\-To\-Dest\-Data (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_abbfbe66b1dc54b0ac83b029b052fb3e1}
Data portion of the first packet in the flow \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 185 of file Flow.\-h.


\begin{DoxyCode}
185 \{ \textcolor{keywordflow}{return} \_firstOrigToDestData; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_aa722f9053c928770e90d689b5d517ec9}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!first\-Orig\-To\-Dest\-Data\-Size@{first\-Orig\-To\-Dest\-Data\-Size}}
\index{first\-Orig\-To\-Dest\-Data\-Size@{first\-Orig\-To\-Dest\-Data\-Size}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{first\-Orig\-To\-Dest\-Data\-Size}]{\setlength{\rightskip}{0pt plus 5cm}size\-\_\-t Vsid\-Common\-::\-Flow\-::first\-Orig\-To\-Dest\-Data\-Size (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_aa722f9053c928770e90d689b5d517ec9}


Definition at line 186 of file Flow.\-h.


\begin{DoxyCode}
186 \{ \textcolor{keywordflow}{return} \_firstOrigToDestDataSize; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a832be3ee7521fdbba1072da2f0106fdf}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!five\-Tuple@{five\-Tuple}}
\index{five\-Tuple@{five\-Tuple}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{five\-Tuple}]{\setlength{\rightskip}{0pt plus 5cm}const {\bf I\-Pv4\-Tuple}\& Vsid\-Common\-::\-Flow\-::five\-Tuple (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a832be3ee7521fdbba1072da2f0106fdf}
Get the five\-Tuple representing this flow. This is taken from the first packet on the flow \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 62 of file Flow.\-h.


\begin{DoxyCode}
62 \{ \textcolor{keywordflow}{return} \_firstPacketTuple; \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a832be3ee7521fdbba1072da2f0106fdf_icgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_common_1_1_flow_a47272e1d764ab23dee120592dd5010eb}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!flow\-Classified@{flow\-Classified}}
\index{flow\-Classified@{flow\-Classified}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{flow\-Classified}]{\setlength{\rightskip}{0pt plus 5cm}bool Vsid\-Common\-::\-Flow\-::flow\-Classified (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a47272e1d764ab23dee120592dd5010eb}


Definition at line 198 of file Flow.\-h.


\begin{DoxyCode}
198 \{ \textcolor{keywordflow}{return} \_flowClassified; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a25be552976420023b17052ee3b4d5bf6}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!flow\-Hash@{flow\-Hash}}
\index{flow\-Hash@{flow\-Hash}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{flow\-Hash}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t Vsid\-Common\-::\-Flow\-::flow\-Hash (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a25be552976420023b17052ee3b4d5bf6}
Get a hash to represent the flow \begin{DoxyReturn}{Returns}
\mbox{[}description\mbox{]} 
\end{DoxyReturn}


Definition at line 68 of file Flow.\-h.


\begin{DoxyCode}
68 \{ \textcolor{keywordflow}{return} \_hash; \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a25be552976420023b17052ee3b4d5bf6_icgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_common_1_1_flow_ac9ab4527fdac8cef6b1680b5c9e62015}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!flow\-State@{flow\-State}}
\index{flow\-State@{flow\-State}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{flow\-State}]{\setlength{\rightskip}{0pt plus 5cm}{\bf State} Vsid\-Common\-::\-Flow\-::flow\-State (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_ac9ab4527fdac8cef6b1680b5c9e62015}


Definition at line 148 of file Flow.\-h.


\begin{DoxyCode}
148 \{ \textcolor{keywordflow}{return} \_flowState; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_ae0497c1d26c120c088994fdb7643ead0}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!have\-Pkts\-In\-Queue@{have\-Pkts\-In\-Queue}}
\index{have\-Pkts\-In\-Queue@{have\-Pkts\-In\-Queue}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{have\-Pkts\-In\-Queue}]{\setlength{\rightskip}{0pt plus 5cm}bool Vsid\-Common\-::\-Flow\-::have\-Pkts\-In\-Queue (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_ae0497c1d26c120c088994fdb7643ead0}


Definition at line 214 of file Flow.\-h.


\begin{DoxyCode}
214 \{ \textcolor{keywordflow}{return} \_pktsInQueue > 0; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_ab9d600f88c2db0a8a8faebe4cdfe5731}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!inc\-Pkts\-In\-Queue@{inc\-Pkts\-In\-Queue}}
\index{inc\-Pkts\-In\-Queue@{inc\-Pkts\-In\-Queue}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{inc\-Pkts\-In\-Queue}]{\setlength{\rightskip}{0pt plus 5cm}void Vsid\-Common\-::\-Flow\-::inc\-Pkts\-In\-Queue (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_ab9d600f88c2db0a8a8faebe4cdfe5731}


Definition at line 212 of file Flow.\-h.


\begin{DoxyCode}
212 \{ \_pktsInQueue++; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_ae437ae88fb48d6ac2880f40fc88195da}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!is\-First\-Packet@{is\-First\-Packet}}
\index{is\-First\-Packet@{is\-First\-Packet}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{is\-First\-Packet}]{\setlength{\rightskip}{0pt plus 5cm}bool Vsid\-Common\-::\-Flow\-::is\-First\-Packet (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_ae437ae88fb48d6ac2880f40fc88195da}


Definition at line 188 of file Flow.\-h.


\begin{DoxyCode}
188 \{ \textcolor{keywordflow}{return} \_isFirstPacket; \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_ae437ae88fb48d6ac2880f40fc88195da_icgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_common_1_1_flow_a3a2a19ce10910e74f43a196ab65f6cd9}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!last\-Packet\-Direction@{last\-Packet\-Direction}}
\index{last\-Packet\-Direction@{last\-Packet\-Direction}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{last\-Packet\-Direction}]{\setlength{\rightskip}{0pt plus 5cm}{\bf Direction} Vsid\-Common\-::\-Flow\-::last\-Packet\-Direction (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a3a2a19ce10910e74f43a196ab65f6cd9}
Direction of the last packet in the flow \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 179 of file Flow.\-h.


\begin{DoxyCode}
179 \{ \textcolor{keywordflow}{return} \_lastPacketDirection; \}
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a3a2a19ce10910e74f43a196ab65f6cd9_icgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_common_1_1_flow_af2613297a470084ea8c4731d42126389}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!last\-Packet\-Timestamp@{last\-Packet\-Timestamp}}
\index{last\-Packet\-Timestamp@{last\-Packet\-Timestamp}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{last\-Packet\-Timestamp}]{\setlength{\rightskip}{0pt plus 5cm}const struct timeval\& Vsid\-Common\-::\-Flow\-::last\-Packet\-Timestamp (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_af2613297a470084ea8c4731d42126389}
Timestamp of the last packet in the flow \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 173 of file Flow.\-h.


\begin{DoxyCode}
173 \{ \textcolor{keywordflow}{return} \_lastPacketTimestamp; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_ab1640288592343532073bf506fc8a23e}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!overall\-Pkt\-Count@{overall\-Pkt\-Count}}
\index{overall\-Pkt\-Count@{overall\-Pkt\-Count}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{overall\-Pkt\-Count}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t Vsid\-Common\-::\-Flow\-::overall\-Pkt\-Count (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_ab1640288592343532073bf506fc8a23e}
Packet count of all packets on a flow \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 161 of file Flow.\-h.


\begin{DoxyCode}
161 \{ \textcolor{keywordflow}{return} \_overallPktCount; \} 
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a8708e13cea69ad630274901ec94b5cf4}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!packet\-Direction@{packet\-Direction}}
\index{packet\-Direction@{packet\-Direction}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{packet\-Direction}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ {\bf Direction} Vsid\-Common\-::\-Flow\-::packet\-Direction (
\begin{DoxyParamCaption}
\item[{const T $\ast$}]{rhs}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a8708e13cea69ad630274901ec94b5cf4}
Check the direction of the packet in the flow U\-N\-K\-N\-O\-W\-N means it's not part of the flow 
\begin{DoxyParams}{Parameters}
{\em packet} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 120 of file Flow.\-h.


\begin{DoxyCode}
121     \{
122         \textcolor{keywordflow}{if}(\_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a6e05cf962bef53a9f3b1772a04e3878f}{protocol}() != rhs->protocol())
123             \textcolor{keywordflow}{return} \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a696b031073e74bf2cb98e5ef201d4aa3}{Direction::UNKNOWN};
124 
125         \textcolor{keywordflow}{if}(\_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_aa1f9b5071312e6062b5bd39ada560c43}{srcIp}() == rhs->srcIp() 
126                 && \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a020b9a4b89155b0e4a796d3367e577eb}{dstIp}() == rhs->dstIp()
127                 && \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a4092c3bd8281c8f5a8972c5c6c6f4bac}{srcPort}() == rhs->srcPort()
128                 && \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_afc04d9dcf937c67ce60a2f2fcc0c7c10}{dstPort}() == rhs->dstPort())
129         \{
130             \textcolor{comment}{// same flow and direction}
131             
132             \textcolor{keywordflow}{return} \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a0d7777af293731f36e6d38a63c40c8d9}{Direction::ORIG\_TO\_DEST};
133         \}
134         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}( \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_aa1f9b5071312e6062b5bd39ada560c43}{srcIp}() == rhs->dstIp() 
135                 && \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a020b9a4b89155b0e4a796d3367e577eb}{dstIp}() == rhs->srcIp()
136                 && \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a4092c3bd8281c8f5a8972c5c6c6f4bac}{srcPort}() == rhs->dstPort()
137                 && \_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_afc04d9dcf937c67ce60a2f2fcc0c7c10}{dstPort}() == rhs->srcPort())
138         \{
139             \textcolor{comment}{// same flow different direction}
140             \textcolor{keywordflow}{return} \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781acec4e9f5cd57d2a319a172cba0a6d505}{Direction::DEST\_TO\_ORIG};
141         \}
142         \textcolor{keywordflow}{else}
143         \{
144             \textcolor{keywordflow}{return} \hyperlink{class_vsid_common_1_1_flow_a82b0cd313a915325b97133fd8e104781a696b031073e74bf2cb98e5ef201d4aa3}{Direction::UNKNOWN};
145         \}
146     \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a8708e13cea69ad630274901ec94b5cf4_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a8708e13cea69ad630274901ec94b5cf4_icgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_common_1_1_flow_a41a3ebb168028d3cf0ea96b7e438ca89}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!pkt\-Count@{pkt\-Count}}
\index{pkt\-Count@{pkt\-Count}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{pkt\-Count}]{\setlength{\rightskip}{0pt plus 5cm}uint32\-\_\-t Vsid\-Common\-::\-Flow\-::pkt\-Count (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a41a3ebb168028d3cf0ea96b7e438ca89}
Packet count for what are considerd data packets. This doesn't consider T\-C\-P packets such as S\-Y\-N, A\-C\-K (with no data) \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 155 of file Flow.\-h.


\begin{DoxyCode}
155 \{ \textcolor{keywordflow}{return} \_pktCount; \} 
\end{DoxyCode}


Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a41a3ebb168028d3cf0ea96b7e438ca89_icgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_common_1_1_flow_a85284a063d691f0c54453695255fe6db}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!same\-Flow@{same\-Flow}}
\index{same\-Flow@{same\-Flow}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{same\-Flow}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ bool Vsid\-Common\-::\-Flow\-::same\-Flow (
\begin{DoxyParamCaption}
\item[{const T $\ast$}]{rhs}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a85284a063d691f0c54453695255fe6db}
Check if the packet is part fo the same flow 
\begin{DoxyParams}{Parameters}
{\em packet} & \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 80 of file Flow.\-h.


\begin{DoxyCode}
81     \{
82         \textcolor{keywordflow}{if}(\_firstPacketTuple.\hyperlink{class_vsid_common_1_1_i_pv4_tuple_a6e05cf962bef53a9f3b1772a04e3878f}{protocol}() != rhs->protocol())
83         \{
84             \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"Not the same flow proto"})
85             return false;
86         \}
87 
88         if(\_firstPacketTuple.srcIp() == rhs->srcIp() 
89                 && \_firstPacketTuple.dstIp() == rhs->dstIp()
90                 && \_firstPacketTuple.srcPort() == rhs->srcPort()
91                 && \_firstPacketTuple.dstPort() == rhs->dstPort())
92         \{
93             \textcolor{comment}{// same flow and direction}
94             \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"same flow and direction"})
95             return true;
96         \}
97         else if( \_firstPacketTuple.srcIp() == rhs->dstIp() 
98                 && \_firstPacketTuple.dstIp() == rhs->srcIp()
99                 && \_firstPacketTuple.srcPort() == rhs->dstPort()
100                 && \_firstPacketTuple.dstPort() == rhs->srcPort())
101         \{
102             \textcolor{comment}{// same flow different direction}
103             \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"same flow different direction"})
104             return true;
105         \}
106         else
107         \{
108             \hyperlink{_logger_8h_a119c1c29ba35a8db38e2358e41167282}{SLOG\_INFO}(<< \textcolor{stringliteral}{"Not the same flow"})
109             return false;
110         \}
111     \}
\end{DoxyCode}


Here is the call graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a85284a063d691f0c54453695255fe6db_cgraph}
\end{center}
\end{figure}




Here is the caller graph for this function\-:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{class_vsid_common_1_1_flow_a85284a063d691f0c54453695255fe6db_icgraph}
\end{center}
\end{figure}


\hypertarget{class_vsid_common_1_1_flow_a8deeaf4162dcc7ab1b3bfe43a60e30ec}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!set\-Finished\-And\-Notified@{set\-Finished\-And\-Notified}}
\index{set\-Finished\-And\-Notified@{set\-Finished\-And\-Notified}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{set\-Finished\-And\-Notified}]{\setlength{\rightskip}{0pt plus 5cm}void Vsid\-Common\-::\-Flow\-::set\-Finished\-And\-Notified (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a8deeaf4162dcc7ab1b3bfe43a60e30ec}


Definition at line 215 of file Flow.\-h.


\begin{DoxyCode}
215 \{ \_flowState =  \hyperlink{class_vsid_common_1_1_flow_a4c78d7517903031a861c7287e706a6c2a055b500bb0ed82a58f138a885208507a}{Flow::State::FINISHED\_NOTIFIED};\}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a79a18af1103ad0571cbc4d7f27522274}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!start\-Timestamp@{start\-Timestamp}}
\index{start\-Timestamp@{start\-Timestamp}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{start\-Timestamp}]{\setlength{\rightskip}{0pt plus 5cm}const struct timeval\& Vsid\-Common\-::\-Flow\-::start\-Timestamp (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a79a18af1103ad0571cbc4d7f27522274}
Start time of the flow \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 167 of file Flow.\-h.


\begin{DoxyCode}
167 \{ \textcolor{keywordflow}{return} \_startTimestamp; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a067c4a0fbf63c7295442c54898d9990d}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!thread\-Queue\-Id@{thread\-Queue\-Id}}
\index{thread\-Queue\-Id@{thread\-Queue\-Id}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{thread\-Queue\-Id}]{\setlength{\rightskip}{0pt plus 5cm}int Vsid\-Common\-::\-Flow\-::thread\-Queue\-Id (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
) const\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a067c4a0fbf63c7295442c54898d9990d}
I\-D of the thread queue that handles this \begin{DoxyReturn}{Returns}

\end{DoxyReturn}


Definition at line 209 of file Flow.\-h.


\begin{DoxyCode}
209 \{ \textcolor{keywordflow}{return} \_threadQueueId; \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_a8bcd68ca197bf35b4655418ee72be9ad}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!thread\-Queue\-Id@{thread\-Queue\-Id}}
\index{thread\-Queue\-Id@{thread\-Queue\-Id}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{thread\-Queue\-Id}]{\setlength{\rightskip}{0pt plus 5cm}void Vsid\-Common\-::\-Flow\-::thread\-Queue\-Id (
\begin{DoxyParamCaption}
\item[{int}]{id}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [inline]}}}\label{class_vsid_common_1_1_flow_a8bcd68ca197bf35b4655418ee72be9ad}


Definition at line 210 of file Flow.\-h.


\begin{DoxyCode}
210 \{ \_threadQueueId = id; \}
\end{DoxyCode}


\subsection{Friends And Related Function Documentation}
\hypertarget{class_vsid_common_1_1_flow_a8b8c36c44b03b0508540ba0c1db05e29}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!operator!=@{operator!=}}
\index{operator!=@{operator!=}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{operator!=}]{\setlength{\rightskip}{0pt plus 5cm}bool operator!= (
\begin{DoxyParamCaption}
\item[{const {\bf Flow} \&}]{lhs, }
\item[{const {\bf Flow} \&}]{rhs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [friend]}}}\label{class_vsid_common_1_1_flow_a8b8c36c44b03b0508540ba0c1db05e29}


Definition at line 262 of file Flow.\-h.


\begin{DoxyCode}
263     \{
264         \textcolor{keywordflow}{return} !(lhs == rhs);
265     \}
\end{DoxyCode}
\hypertarget{class_vsid_common_1_1_flow_adf202422cece5e6dc6ad096f58c35b7c}{\index{Vsid\-Common\-::\-Flow@{Vsid\-Common\-::\-Flow}!operator==@{operator==}}
\index{operator==@{operator==}!VsidCommon::Flow@{Vsid\-Common\-::\-Flow}}
\subsubsection[{operator==}]{\setlength{\rightskip}{0pt plus 5cm}bool operator== (
\begin{DoxyParamCaption}
\item[{const {\bf Flow} \&}]{lhs, }
\item[{const {\bf Flow} \&}]{rhs}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [friend]}}}\label{class_vsid_common_1_1_flow_adf202422cece5e6dc6ad096f58c35b7c}


Definition at line 257 of file Flow.\-h.


\begin{DoxyCode}
258     \{
259         \textcolor{keywordflow}{return} lhs.sameFlow(&rhs.fiveTuple());
260     \}
\end{DoxyCode}


The documentation for this class was generated from the following files\-:\begin{DoxyCompactItemize}
\item 
src/common/inc/\hyperlink{_flow_8h}{Flow.\-h}\item 
src/common/src/\hyperlink{_flow_8cpp}{Flow.\-cpp}\end{DoxyCompactItemize}
